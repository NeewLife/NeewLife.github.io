
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="개발 메모장">
    <title>day 0706 - 개발 메모장</title>
    <meta name="author" content="오세영">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"오세영","sameAs":[]},"articleBody":"데이터 분석 (머신러닝, 딥러닝) 프로세스\n\n\n\n데이터 불러오기\n\nCSV, 오라클, MySQL, PostgreSQL, 클라우드 DB연동\n\n\n탐색적 자료분석\n\n데이터 전처리 및 가공\n\n\n잠정적인 컬럼의 갯수를 지정해야 함\n\n머신러닝 모델 (&#x3D;통계 모델링, t.test, 분산분석, 교차분석)\n\n머신러닝 모델의 경우 배포 (현재는 다루지 않음 X)\n\nJSP-스프링 웹개발 시, 배우게 됨\n\n\n통계 모델링 경우, p-value 값 기준으로, 귀무가설 및 대립가설 검정\n\n(공통) 결과 보고서를 작성해야함\n\nPPT 만들어야 함.\n\n\n\n그래프 복습\n수치형 데이터 시각화\n범주형 데이터 시각화\n데이터 관계 시각화\nmatplotlib 라이브러리 방법(복잡)\nseaborn 라이브러리 방법(단순)\n복잡한 그래프 그릴 때 –&gt; matpltoltib\n1줄 그래프 –&gt; seaborn (처음에는 이걸로)\n\n\n\n수치형 데이터 시각화123import seaborn as snstitanic = sns.load_dataset(&#x27;titanic&#x27;)titanic.head()\n\n\n\n\n\n  \n    \n      \n\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n\n\n\n  \n    \n      \n      survived\n      pclass\n      sex\n      age\n      sibsp\n      parch\n      fare\n      embarked\n      class\n      who\n      adult_male\n      deck\n      embark_town\n      alive\n      alone\n    \n  \n  \n    \n      0\n      0\n      3\n      male\n      22.0\n      1\n      0\n      7.2500\n      S\n      Third\n      man\n      True\n      NaN\n      Southampton\n      no\n      False\n    \n    \n      1\n      1\n      1\n      female\n      38.0\n      1\n      0\n      71.2833\n      C\n      First\n      woman\n      False\n      C\n      Cherbourg\n      yes\n      False\n    \n    \n      2\n      1\n      3\n      female\n      26.0\n      0\n      0\n      7.9250\n      S\n      Third\n      woman\n      False\n      NaN\n      Southampton\n      yes\n      True\n    \n    \n      3\n      1\n      1\n      female\n      35.0\n      1\n      0\n      53.1000\n      S\n      First\n      woman\n      False\n      C\n      Southampton\n      yes\n      False\n    \n    \n      4\n      0\n      3\n      male\n      35.0\n      0\n      0\n      8.0500\n      S\n      Third\n      man\n      True\n      NaN\n      Southampton\n      no\n      True\n    \n  \n\n\n      \n\n  &lt;svg xmlns&#x3D;”http://www.w3.org/2000/svg“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”       width&#x3D;”24px”&gt;                \n  \n    .colab-df-container {\n      display:flex;\n      flex-wrap:wrap;\n      gap: 12px;\n    }\n\n    .colab-df-convert {\n      background-color: #E8F0FE;\n      border: none;\n      border-radius: 50%;\n      cursor: pointer;\n      display: none;\n      fill: #1967D2;\n      height: 32px;\n      padding: 0 0 0 0;\n      width: 32px;\n    }\n\n    .colab-df-convert:hover {\n      background-color: #E2EBFA;\n      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n      fill: #174EA6;\n    }\n\n    [theme=dark] .colab-df-convert {\n      background-color: #3B4455;\n      fill: #D2E3FC;\n    }\n\n    [theme=dark] .colab-df-convert:hover {\n      background-color: #434B5C;\n      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n      fill: #FFFFFF;\n    }\n  \n\n  &lt;script&gt;\n    const buttonEl =\n      document.querySelector(&#39;#df-cbd7e312-07d2-4e3c-a0c0-3f889c1c6405 button.colab-df-convert&#39;);\n    buttonEl.style.display =\n      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;\n\n    async function convertToInteractive(key) &#123;\n      const element = document.querySelector(&#39;#df-cbd7e312-07d2-4e3c-a0c0-3f889c1c6405&#39;);\n      const dataTable =\n        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,\n                                                 [key], &#123;&#125;);\n      if (!dataTable) return;\n\n      const docLinkHtml = &#39;Like what you see? Visit the &#39; +\n        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;\n        + &#39; to learn more about interactive tables.&#39;;\n      element.innerHTML = &#39;&#39;;\n      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;\n      await google.colab.output.renderOutput(dataTable, element);\n      const docLink = document.createElement(&#39;div&#39;);\n      docLink.innerHTML = docLinkHtml;\n      element.appendChild(docLink);\n    &#125;\n  &lt;/script&gt;\n&lt;/div&gt;\n\n  \n\n\n\n\n\n12# 히스토그램sns.histplot(data = titanic, x =&#x27;age&#x27;, bins = 10, hue = &#x27;alive&#x27;, multiple = &#x27;stack&#x27;)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff99b22f490&gt;\n\n\n\n위 그래프를 보아하니 ~~~~ 이겠네 하고 분석\n\n123# 커널밀도추정 함수 그래프# 연속형 데이터 1개만 쓸 때 사용sns. kdeplot(data = titanic, x = &#x27;age&#x27;, hue = &#x27;alive&#x27;, multiple = &#x27;stack&#x27;)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff99a0c97d0&gt;\n\n\n분포도\n수치형 데이터 한개 컬럼의 분포를 나타내는 그래프\n정규분포인가? 중심적으로 봐야 함\n정규분포 : 평균 중심으로 좌우 대칭이 똑같은 그래프\n\n\n\n1sns.displot(data = titanic, x =&#x27;age&#x27;)\n\n\n\n\n&lt;seaborn.axisgrid.FacetGrid at 0x7ff99a226910&gt;\n\n\n1sns.displot(data = titanic, x = &#x27;age&#x27;, kde = True)\n\n\n\n\n&lt;seaborn.axisgrid.FacetGrid at 0x7ff999f65d90&gt;\n\n\n범주형 데이터 시각화\nx축 범주형, y축 수치데이터\n\n123# 막대 그래프sns.barplot(x = &#x27;class&#x27;, y = &#x27;fare&#x27;, data = titanic)# 회색 막대기가 평균치, 위아래로 튀어나와 있는 정도를 error bar 오차막대 라고 한다.\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999e93b50&gt;\n\n\n123# 포인트 plotsns.pointplot(x = &#x27;class&#x27;, y = &#x27;fare&#x27;, data = titanic)# 상황에 맞춰서 그래프 모형은 다르게 쓴다. 내용은 똑같음\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999df6410&gt;\n\n\n12# 박스 plotsns.boxplot(x = &#x27;class&#x27;, y = &#x27;age&#x27;, data = titanic)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999ddcbd0&gt;\n\n\n\n박스 plot\n제 1사분위 : 전체 데이터 중 하위 25%(박스 아랫변)\n제 2사분위 : 25% ~ 50% (박스 중간)\n제 3사분위 : 50% ~ 75% (박스 윗변)\n사분위 범위 수(IQR) : 제 3사분위 - 제 1사분위\n최댓값 : 제 3사분위 + (1.5 * IQ)\n\n12# 바이올린 플롯sns.violinplot(x = &#x27;class&#x27;, y = &#x27;age&#x27;, hue = &#x27;sex&#x27;, data = titanic, split = True)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999d09e10&gt;\n\n\n카운트 plot\n범주형 데이터의 갯수 확인 할 때 사용\n\n1sns.countplot(x = &#x27;class&#x27;, data = titanic)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999c9d290&gt;\n\n\n데이터 관계 시각화\n여러 데이터 사이의 관계도 파악 위한 그래프\n\n히트맵12flights= sns.load_dataset(&#x27;flights&#x27;)flights.head()\n\n\n\n\n\n  \n    \n      \n\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n\n\n\n  \n    \n      \n      year\n      month\n      passengers\n    \n  \n  \n    \n      0\n      1949\n      Jan\n      112\n    \n    \n      1\n      1949\n      Feb\n      118\n    \n    \n      2\n      1949\n      Mar\n      132\n    \n    \n      3\n      1949\n      Apr\n      129\n    \n    \n      4\n      1949\n      May\n      121\n    \n  \n\n\n      \n\n  &lt;svg xmlns&#x3D;”http://www.w3.org/2000/svg“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”       width&#x3D;”24px”&gt;                \n  \n    .colab-df-container {\n      display:flex;\n      flex-wrap:wrap;\n      gap: 12px;\n    }\n\n    .colab-df-convert {\n      background-color: #E8F0FE;\n      border: none;\n      border-radius: 50%;\n      cursor: pointer;\n      display: none;\n      fill: #1967D2;\n      height: 32px;\n      padding: 0 0 0 0;\n      width: 32px;\n    }\n\n    .colab-df-convert:hover {\n      background-color: #E2EBFA;\n      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n      fill: #174EA6;\n    }\n\n    [theme=dark] .colab-df-convert {\n      background-color: #3B4455;\n      fill: #D2E3FC;\n    }\n\n    [theme=dark] .colab-df-convert:hover {\n      background-color: #434B5C;\n      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n      fill: #FFFFFF;\n    }\n  \n\n  &lt;script&gt;\n    const buttonEl =\n      document.querySelector(&#39;#df-c3854d41-b9f5-448f-8697-3ef25f747e15 button.colab-df-convert&#39;);\n    buttonEl.style.display =\n      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;\n\n    async function convertToInteractive(key) &#123;\n      const element = document.querySelector(&#39;#df-c3854d41-b9f5-448f-8697-3ef25f747e15&#39;);\n      const dataTable =\n        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,\n                                                 [key], &#123;&#125;);\n      if (!dataTable) return;\n\n      const docLinkHtml = &#39;Like what you see? Visit the &#39; +\n        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;\n        + &#39; to learn more about interactive tables.&#39;;\n      element.innerHTML = &#39;&#39;;\n      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;\n      await google.colab.output.renderOutput(dataTable, element);\n      const docLink = document.createElement(&#39;div&#39;);\n      docLink.innerHTML = docLinkHtml;\n      element.appendChild(docLink);\n    &#125;\n  &lt;/script&gt;\n&lt;/div&gt;\n\n  \n\n\n\n\n\n각 연도별, 월별 승객 수 구하기\n\n123# flights[&#x27;year&#x27;].value_counts()flights_pivot = flights.pivot(index = &#x27;month&#x27;, columns = &#x27;year&#x27;, values = &#x27;passengers&#x27;)flights_pivot\n\n\n\n\n\n  \n    \n      \n\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n\n\n\n  \n    \n      year\n      1949\n      1950\n      1951\n      1952\n      1953\n      1954\n      1955\n      1956\n      1957\n      1958\n      1959\n      1960\n    \n    \n      month\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n  \n    \n      Jan\n      112\n      115\n      145\n      171\n      196\n      204\n      242\n      284\n      315\n      340\n      360\n      417\n    \n    \n      Feb\n      118\n      126\n      150\n      180\n      196\n      188\n      233\n      277\n      301\n      318\n      342\n      391\n    \n    \n      Mar\n      132\n      141\n      178\n      193\n      236\n      235\n      267\n      317\n      356\n      362\n      406\n      419\n    \n    \n      Apr\n      129\n      135\n      163\n      181\n      235\n      227\n      269\n      313\n      348\n      348\n      396\n      461\n    \n    \n      May\n      121\n      125\n      172\n      183\n      229\n      234\n      270\n      318\n      355\n      363\n      420\n      472\n    \n    \n      Jun\n      135\n      149\n      178\n      218\n      243\n      264\n      315\n      374\n      422\n      435\n      472\n      535\n    \n    \n      Jul\n      148\n      170\n      199\n      230\n      264\n      302\n      364\n      413\n      465\n      491\n      548\n      622\n    \n    \n      Aug\n      148\n      170\n      199\n      242\n      272\n      293\n      347\n      405\n      467\n      505\n      559\n      606\n    \n    \n      Sep\n      136\n      158\n      184\n      209\n      237\n      259\n      312\n      355\n      404\n      404\n      463\n      508\n    \n    \n      Oct\n      119\n      133\n      162\n      191\n      211\n      229\n      274\n      306\n      347\n      359\n      407\n      461\n    \n    \n      Nov\n      104\n      114\n      146\n      172\n      180\n      203\n      237\n      271\n      305\n      310\n      362\n      390\n    \n    \n      Dec\n      118\n      140\n      166\n      194\n      201\n      229\n      278\n      306\n      336\n      337\n      405\n      432\n    \n  \n\n\n      \n\n  &lt;svg xmlns&#x3D;”http://www.w3.org/2000/svg“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”       width&#x3D;”24px”&gt;                \n  \n    .colab-df-container {\n      display:flex;\n      flex-wrap:wrap;\n      gap: 12px;\n    }\n\n    .colab-df-convert {\n      background-color: #E8F0FE;\n      border: none;\n      border-radius: 50%;\n      cursor: pointer;\n      display: none;\n      fill: #1967D2;\n      height: 32px;\n      padding: 0 0 0 0;\n      width: 32px;\n    }\n\n    .colab-df-convert:hover {\n      background-color: #E2EBFA;\n      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n      fill: #174EA6;\n    }\n\n    [theme=dark] .colab-df-convert {\n      background-color: #3B4455;\n      fill: #D2E3FC;\n    }\n\n    [theme=dark] .colab-df-convert:hover {\n      background-color: #434B5C;\n      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n      fill: #FFFFFF;\n    }\n  \n\n  &lt;script&gt;\n    const buttonEl =\n      document.querySelector(&#39;#df-e33832bd-f6d9-469d-92ff-6457ffffde82 button.colab-df-convert&#39;);\n    buttonEl.style.display =\n      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;\n\n    async function convertToInteractive(key) &#123;\n      const element = document.querySelector(&#39;#df-e33832bd-f6d9-469d-92ff-6457ffffde82&#39;);\n      const dataTable =\n        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,\n                                                 [key], &#123;&#125;);\n      if (!dataTable) return;\n\n      const docLinkHtml = &#39;Like what you see? Visit the &#39; +\n        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;\n        + &#39; to learn more about interactive tables.&#39;;\n      element.innerHTML = &#39;&#39;;\n      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;\n      await google.colab.output.renderOutput(dataTable, element);\n      const docLink = document.createElement(&#39;div&#39;);\n      docLink.innerHTML = docLinkHtml;\n      element.appendChild(docLink);\n    &#125;\n  &lt;/script&gt;\n&lt;/div&gt;\n\n  \n\n\n\n\n\n1sns.heatmap(data = flights_pivot)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999c0ff90&gt;\n\n\n12# 라인플롯sns.lineplot(x = &#x27;year&#x27;, y = &#x27;passengers&#x27;, data = flights)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999bf9d90&gt;\n\n\n123# 산점도tips = sns.load_dataset(&#x27;tips&#x27;)tips.head()\n\n\n\n\n\n  \n    \n      \n\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n\n\n\n  \n    \n      \n      total_bill\n      tip\n      sex\n      smoker\n      day\n      time\n      size\n    \n  \n  \n    \n      0\n      16.99\n      1.01\n      Female\n      No\n      Sun\n      Dinner\n      2\n    \n    \n      1\n      10.34\n      1.66\n      Male\n      No\n      Sun\n      Dinner\n      3\n    \n    \n      2\n      21.01\n      3.50\n      Male\n      No\n      Sun\n      Dinner\n      3\n    \n    \n      3\n      23.68\n      3.31\n      Male\n      No\n      Sun\n      Dinner\n      2\n    \n    \n      4\n      24.59\n      3.61\n      Female\n      No\n      Sun\n      Dinner\n      4\n    \n  \n\n\n      \n\n  &lt;svg xmlns&#x3D;”http://www.w3.org/2000/svg“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”       width&#x3D;”24px”&gt;                \n  \n    .colab-df-container {\n      display:flex;\n      flex-wrap:wrap;\n      gap: 12px;\n    }\n\n    .colab-df-convert {\n      background-color: #E8F0FE;\n      border: none;\n      border-radius: 50%;\n      cursor: pointer;\n      display: none;\n      fill: #1967D2;\n      height: 32px;\n      padding: 0 0 0 0;\n      width: 32px;\n    }\n\n    .colab-df-convert:hover {\n      background-color: #E2EBFA;\n      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n      fill: #174EA6;\n    }\n\n    [theme=dark] .colab-df-convert {\n      background-color: #3B4455;\n      fill: #D2E3FC;\n    }\n\n    [theme=dark] .colab-df-convert:hover {\n      background-color: #434B5C;\n      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n      fill: #FFFFFF;\n    }\n  \n\n  &lt;script&gt;\n    const buttonEl =\n      document.querySelector(&#39;#df-ca53f1d3-b076-478e-a68c-226957b2fa6b button.colab-df-convert&#39;);\n    buttonEl.style.display =\n      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;\n\n    async function convertToInteractive(key) &#123;\n      const element = document.querySelector(&#39;#df-ca53f1d3-b076-478e-a68c-226957b2fa6b&#39;);\n      const dataTable =\n        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,\n                                                 [key], &#123;&#125;);\n      if (!dataTable) return;\n\n      const docLinkHtml = &#39;Like what you see? Visit the &#39; +\n        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;\n        + &#39; to learn more about interactive tables.&#39;;\n      element.innerHTML = &#39;&#39;;\n      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;\n      await google.colab.output.renderOutput(dataTable, element);\n      const docLink = document.createElement(&#39;div&#39;);\n      docLink.innerHTML = docLinkHtml;\n      element.appendChild(docLink);\n    &#125;\n  &lt;/script&gt;\n&lt;/div&gt;\n\n  \n\n\n\n\n\n두개의 연속형 데이터\n\n1sns.scatterplot(x = &#x27;total_bill&#x27;, y = &#x27;tip&#x27;, hue = &#x27;sex&#x27;, data = tips)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999b3ab10&gt;\n\n\n12# 회귀선sns.regplot(x = &#x27;total_bill&#x27;, y = &#x27;tip&#x27;, data = tips)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999f45350&gt;\n\n\n머신러닝 리뷰\n가장 인기 있는 모델\nLightGBM, XGboost\n\n\n\n선형 회귀\n선형 회귀식을 찾는 것이 중요\n$y &#x3D; 3x + 4$ 에 근사한 데이터 50개 생성\n\n12345678910111213141516import numpy as npimport pandas as pd# 시드값 고정np.random.seed(0)intercept = 4  # 절편, 상수slope = 3  # 기울기# 변동성 주기 위해 노이즈를 생성noise = np.random.randn(50, 1)x = 5 * np.random.rand(50, 1)  # 0 과 5 사이의 실숫값 50개 생성y = slope * x + intercept + noise# 데이터 프레임 생성data = pd.DataFrame(&#123;&#x27;X&#x27; : x[:, 0], &#x27;Y&#x27; : y[:, 0]&#125;)print(data)\n\n           X          Y\n0   0.794848   8.148596\n1   0.551876   6.055784\n2   3.281648  14.823682\n3   0.690915   8.313637\n4   0.982912   8.816293\n5   1.843626   8.553600\n6   4.104966  17.264987\n7   0.485506   5.305162\n8   4.189725  16.465955\n9   0.480492   5.852075\n10  4.882297  18.790936\n11  2.343256  12.484042\n12  4.883805  19.412454\n13  3.024228  13.194358\n14  3.696318  15.532817\n15  0.195939   4.921491\n16  1.414035   9.736184\n17  0.600983   5.597790\n18  1.480701   8.755171\n19  0.593639   4.926820\n20  1.589916   6.216758\n21  2.071315  10.867564\n22  0.320737   5.826649\n23  3.462361  13.644917\n24  2.833007  14.768776\n25  1.326947   6.526477\n26  2.616240  11.894479\n27  0.469703   5.221924\n28  2.879732  14.171977\n29  4.646481  19.408802\n30  1.592845   8.933482\n31  3.337052  14.389318\n32  0.658989   5.089182\n33  3.581636  12.764112\n34  1.447030   7.993179\n35  0.915957   6.904219\n36  2.932565  14.027985\n37  0.100538   5.503993\n38  4.144700  16.046774\n39  0.023477   3.768129\n40  3.389083  13.118695\n41  1.350040   6.630102\n42  3.675970  13.321640\n43  4.810943  20.383604\n44  1.243766   7.221645\n45  2.880787  12.204286\n46  2.960210  11.627834\n47  2.861260  13.361269\n48  1.115408   5.732327\n49  4.763745  18.078495\n\n1234import matplotlib.pyplot as pltfig, ax = plt.subplots()ax.scatter(data[&#x27;X&#x27;], data[&#x27;Y&#x27;])plt.show\n\n\n\n\n&lt;function matplotlib.pyplot.show&gt;\n\n\n12import seaborn as sns sns.scatterplot(x = &#x27;X&#x27;, y = &#x27;Y&#x27;, data = data)\n\n\n\n\n&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff99996ef10&gt;\n\n\n선형회귀 모형 훈련\n모형 생성 후, 회귀계수 3과 y절편 4에 근사한 값이 나와야 함\n\n123456from sklearn.linear_model import LinearRegressionlr_model = LinearRegression()   # 선형 회귀 모델lr_model.fit(x, y)    # 모델 훈련print(&#x27;y절편:&#x27;, lr_model.intercept_)print(&#x27;회귀계수:&#x27;, lr_model.coef_)\n\ny절편: [4.05757639]\n회귀계수: [[3.03754061]]\n\n1234567891011# 예측값y_pred = lr_model.predict(x)fig, ax = plt.subplots()ax.scatter(x, y)ax.plot(x, y_pred, color=&#x27;green&#x27;)# slope, intercept label = &#x27;slope: &#123;&#125;\\nintercept: &#123;&#125;&#x27;.format(round(lr_model.coef_[0][0], 2), round(lr_model.intercept_[0], 2))ax.text(3.5, 4, label, style =&#x27;italic&#x27;,         fontsize = 10, color =&quot;green&quot;)plt.show()\n\n\n\n로지스틱 회귀1234567891011121314151617181920import numpy as npimport matplotlib.pyplot as pltdef sigmoid(arr, scale=1):    arr = np.asarray(arr)    result = 1/(1 + np.exp(-arr*scale))    return resultx = np.linspace(-6, 6)y = sigmoid(x)fig, ax = plt.subplots()ax.plot(x, y)ax.grid(which=&#x27;major&#x27;, axis=&#x27;y&#x27;, linestyle=&#x27;--&#x27;)ax.axvline(x=0, color=&#x27;r&#x27;, linestyle=&#x27;--&#x27;, linewidth=1)ax.set_ylim(0,1)ax.set_yticks([0, 1, 0.5])ax.text(0-0.1, 0.5, &#x27;0.5&#x27;, ha=&#x27;right&#x27;)ax.set_title(&#x27;Sigmoid Graph&#x27;)plt.show()\n\n\n\n12345678910111213# 라이브러리 불러오기import matplotlib.pyplot as pltimport numpy as npfrom sklearn.linear_model import LogisticRegressionfrom sklearn.metrics import classification_report, confusion_matrix# 데이터 가져오기x = np.arange(10).reshape(-1, 1)y = np.array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1])# 모델 생성 및 학습model = LogisticRegression(solver=&#x27;liblinear&#x27;, C=10.0, random_state=0)model.fit(x, y)\n\n\n\n\nLogisticRegression(C=10.0, random_state=0, solver=&#39;liblinear&#39;)\n\n123# 모형 평가p_pred = model.predict_proba(x)print(&#x27;p_pred&#x27;, p_pred, sep = &#x27;\\n&#x27;)\n\np_pred\n[[0.97979027 0.02020973]\n [0.94958202 0.05041798]\n [0.87976149 0.12023851]\n [0.73975066 0.26024934]\n [0.52477284 0.47522716]\n [0.30020373 0.69979627]\n [0.1428487  0.8571513 ]\n [0.06080627 0.93919373]\n [0.02453462 0.97546538]\n [0.00967652 0.99032348]]\n\n12y_pred = model.predict(x)print(&#x27;y_pred&#x27;, y_pred)\n\ny_pred [0 0 0 0 0 1 1 1 1 1]\n\n12345678910fig, ax = plt.subplots()ax.scatter(x, y)ax.plot(x, p_pred[:, 1], color = &#x27;black&#x27;,  marker=&#x27;o&#x27;, markersize=6)ax.plot()ax.set_xticks(x)ax.set_yticks(np.arange(0, 1.1, 0.1))ax.grid(which=&#x27;major&#x27;, alpha=0.5)plt.show()\n\n\n\n12conf_m = confusion_matrix(y, y_pred)print(conf_m)\n\n[[5 0]\n [0 5]]\n\n123456789101112cm = confusion_matrix(y, y_pred)fig, ax = plt.subplots(figsize=(8, 8))ax.imshow(cm, cmap = &#x27;Pastel2&#x27;)ax.grid(False)ax.xaxis.set(ticks=(0, 1), ticklabels=(&#x27;Predicted 0&#x27;, &#x27;Predicted 1&#x27;))ax.yaxis.set(ticks=(0, 1), ticklabels=(&#x27;Actual 0&#x27;, &#x27;Actual 1&#x27;))ax.set_ylim(1.5, -0.5)for i in range(2):    for j in range(2):        ax.text(j, i, cm[i, j], ha=&#x27;center&#x27;, va=&#x27;center&#x27;, color=&#x27;black&#x27;, fontsize=20)plt.show()\n\n\n\n결정 트리\n분류와 회귀 문제에 모두 사용 가능\n\n주요 개념\n작동 원리\n데이터를 가장 잘 구분하는 조건을 정함.\n조건을 기준으로 데이터를 두 범주로 나눔\n나뉜 각 범주의 데이터를 구분하는 조건을 정함\n각 조건을 기준으로 데이터를 두 범주로 나눔\n언제까지 계속 분할할지 정한 후, 최종 결정 값을 구함.\n\n\n불순도(Impurity)\n한 범주 안에 서로 다른 데이터가 얼마나 섞여 있는지 나타냄\n흰색과 검은색이 50:50으로 섞여 있다. (불순도 최대)\n흰색과 검은색으로 완전 분리 되었다. (불순도 최소)\n\n\n엔트로피(Entropy)\n불확실한 정도를 의미함. 0 ~ 1로 정함.\n흰색과 검은색이 50:50으로 섞여 있다. 엔트로피 1\n흰색과 검은색으로 완전 분리 되었다. 엔트로피 0\n\n\n정보이득(Information Gain)\n1에서 엔트로피를 뺀 수치\n정보 이득을 최대화하는 방향(엔트로피를 최소화 하는 방향)으로 노드를 분할함\n\n\n지니 불순도(Gini Impurity)\n지니 불순도 값이 클수록 불순도도 높고, 작을수록 불순도도 낮음. 엔트로피와 마찬가지로 지니 불순도가 낮아지는 방향으로 노드 분할함.\n\n\n\n1234567from sklearn.tree import DecisionTreeClassifierfrom sklearn.model_selection import train_test_split import seaborn as sns # tips 데이터셋 titanic = sns.load_dataset(&#x27;titanic&#x27;)titanic.info()\n\n&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;\nRangeIndex: 891 entries, 0 to 890\nData columns (total 15 columns):\n #   Column       Non-Null Count  Dtype   \n---  ------       --------------  -----   \n 0   survived     891 non-null    int64   \n 1   pclass       891 non-null    int64   \n 2   sex          891 non-null    object  \n 3   age          714 non-null    float64 \n 4   sibsp        891 non-null    int64   \n 5   parch        891 non-null    int64   \n 6   fare         891 non-null    float64 \n 7   embarked     889 non-null    object  \n 8   class        891 non-null    category\n 9   who          891 non-null    object  \n 10  adult_male   891 non-null    bool    \n 11  deck         203 non-null    category\n 12  embark_town  889 non-null    object  \n 13  alive        891 non-null    object  \n 14  alone        891 non-null    bool    \ndtypes: bool(2), category(2), float64(2), int64(4), object(5)\nmemory usage: 80.7+ KB\n\n\nsurvived의 비율을 구한다.\n0 : 사망자\n1 : 생존자\n\n\n\n1titanic[&#x27;survived&#x27;].value_counts()\n\n\n\n\n0    549\n1    342\nName: survived, dtype: int64\n\n1234567# 데이터 추출X = titanic[[&#x27;pclass&#x27;, &#x27;parch&#x27;, &#x27;fare&#x27;]]y = titanic[&#x27;survived&#x27;]# 훈련데이터, 테스트 데이터 분리X_train, X_test, y_train, y_test = train_test_split(X, y, stratify = y, test_size = 0.3, random_state=42)X_train.shape, X_test.shape, y_train.shape, y_test.shape\n\n\n\n\n((623, 3), (268, 3), (623,), (268,))\n\n12345tree_model = DecisionTreeClassifier()tree_model.fit(X_train, y_train)acc = tree_model.score(X_test, y_test)print(f&#x27;모형 정확도 : &#123;acc:.3f&#125;&#x27;) # 정확도 측정\n\n모형 정확도 : 0.675\n\n랜덤 포레스트12345678910111213141516171819from sklearn.ensemble import RandomForestClassifierfrom sklearn.model_selection import train_test_split import seaborn as sns # tips 데이터셋 titanic = sns.load_dataset(&#x27;titanic&#x27;)X = titanic[[&#x27;pclass&#x27;, &#x27;parch&#x27;, &#x27;fare&#x27;]]y = titanic[&#x27;survived&#x27;]# 훈련데이터, 테스트 데이터 분리X_train, X_test, y_train, y_test = train_test_split(X, y, stratify = y, test_size = 0.3, random_state=42)# 모델 훈련rf_model = RandomForestClassifier(random_state=42) # 랜덤 포레스트 정의rf_model.fit(X_train, y_train)acc = rf_model.score(X_test, y_test)print(f&#x27;모형 정확도 : &#123;acc:.3f&#125;&#x27;) # 정확도 측정\n\n모형 정확도 : 0.675\n\n","dateCreated":"2022-07-06T17:16:55+09:00","dateModified":"2022-07-10T23:26:41+09:00","datePublished":"2022-07-06T17:16:55+09:00","description":"데이터 분석 (머신러닝, 딥러닝) 프로세스","headline":"day 0706","image":["image.png"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://neewlife.github.io/2022/07/06/day0706_1/"},"publisher":{"@type":"Organization","name":"오세영","sameAs":[]},"url":"https://neewlife.github.io/2022/07/06/day0706_1/","thumbnailUrl":"image.png"}</script>
    <meta name="description" content="데이터 분석 (머신러닝, 딥러닝) 프로세스">
<meta property="og:type" content="blog">
<meta property="og:title" content="day 0706">
<meta property="og:url" content="https://neewlife.github.io/2022/07/06/day0706_1/index.html">
<meta property="og:site_name" content="개발 메모장">
<meta property="og:description" content="데이터 분석 (머신러닝, 딥러닝) 프로세스">
<meta property="og:locale" content="ko_KR">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_4_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_6_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_8_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_9_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_11_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_12_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_13_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_15_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_17_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_23_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_24_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_27_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_28_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_32_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_33_1.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_36_0.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_38_0.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_42_0.png">
<meta property="og:image" content="https://neewlife.github.io/images/0706/output_44_0.png">
<meta property="article:published_time" content="2022-07-06T08:16:55.000Z">
<meta property="article:modified_time" content="2022-07-10T14:26:41.663Z">
<meta property="article:author" content="오세영">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://neewlife.github.io/images/0706/output_4_1.png">
    
    
        
    
    
    
        <meta property="og:image" content="https://NeewLife.github.io/2022/07/06/day0706_1/image.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://NeewLife.github.io/2022/07/06/day0706_1/image.png"/>
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    
        
            
<link rel="stylesheet" href="/assets/css/gitment.css">

        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            개발 메모장
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="링크 열기: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="카테고리"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="태그"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="아카이브"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            day 0706
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2022-07-06T17:16:55+09:00">
	
		    2022/07/06
    	
    </time>
    
        <span>카테고리 </span>
        
    <a class="category-link" href="/categories/Python/">Python</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h4 id="데이터-분석-머신러닝-딥러닝-프로세스"><a href="#데이터-분석-머신러닝-딥러닝-프로세스" class="headerlink" title="데이터 분석 (머신러닝, 딥러닝) 프로세스"></a>데이터 분석 (머신러닝, 딥러닝) 프로세스</h4><span id="more"></span>


<ul>
<li><p>데이터 불러오기</p>
<ul>
<li>CSV, 오라클, MySQL, PostgreSQL, 클라우드 DB연동</li>
</ul>
</li>
<li><p>탐색적 자료분석</p>
<ul>
<li>데이터 전처리 및 가공</li>
</ul>
</li>
<li><p>잠정적인 컬럼의 갯수를 지정해야 함</p>
</li>
<li><p>머신러닝 모델 (&#x3D;통계 모델링, t.test, 분산분석, 교차분석)</p>
</li>
<li><p>머신러닝 모델의 경우 배포 (현재는 다루지 않음 X)</p>
<ul>
<li>JSP-스프링 웹개발 시, 배우게 됨</li>
</ul>
</li>
<li><p>통계 모델링 경우, p-value 값 기준으로, 귀무가설 및 대립가설 검정</p>
</li>
<li><p>(공통) 결과 보고서를 작성해야함</p>
<ul>
<li>PPT 만들어야 함.</li>
</ul>
</li>
</ul>
<h2 id="그래프-복습"><a href="#그래프-복습" class="headerlink" title="그래프 복습"></a>그래프 복습</h2><ul>
<li>수치형 데이터 시각화</li>
<li>범주형 데이터 시각화</li>
<li>데이터 관계 시각화</li>
<li>matplotlib 라이브러리 방법(복잡)</li>
<li>seaborn 라이브러리 방법(단순)<ul>
<li>복잡한 그래프 그릴 때 –&gt; matpltoltib</li>
<li>1줄 그래프 –&gt; seaborn (처음에는 이걸로)</li>
</ul>
</li>
</ul>
<h3 id="수치형-데이터-시각화"><a href="#수치형-데이터-시각화" class="headerlink" title="수치형 데이터 시각화"></a>수치형 데이터 시각화</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>)</span><br><span class="line">titanic.head()</span><br></pre></td></tr></table></figure>





  <div id="df-cbd7e312-07d2-4e3c-a0c0-3f889c1c6405">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cbd7e312-07d2-4e3c-a0c0-3f889c1c6405')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-cbd7e312-07d2-4e3c-a0c0-3f889c1c6405 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-cbd7e312-07d2-4e3c-a0c0-3f889c1c6405&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 히스토그램</span></span><br><span class="line">sns.histplot(data = titanic, x =<span class="string">&#x27;age&#x27;</span>, bins = <span class="number">10</span>, hue = <span class="string">&#x27;alive&#x27;</span>, multiple = <span class="string">&#x27;stack&#x27;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff99b22f490&gt;
</code></pre>
<p><img src="/images/0706/output_4_1.png" alt="png"></p>
<ul>
<li>위 그래프를 보아하니 ~~~~ 이겠네 하고 분석</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 커널밀도추정 함수 그래프</span></span><br><span class="line"><span class="comment"># 연속형 데이터 1개만 쓸 때 사용</span></span><br><span class="line">sns. kdeplot(data = titanic, x = <span class="string">&#x27;age&#x27;</span>, hue = <span class="string">&#x27;alive&#x27;</span>, multiple = <span class="string">&#x27;stack&#x27;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff99a0c97d0&gt;
</code></pre>
<p><img src="/images/0706/output_6_1.png" alt="png"></p>
<h4 id="분포도"><a href="#분포도" class="headerlink" title="분포도"></a>분포도</h4><ul>
<li>수치형 데이터 한개 컬럼의 분포를 나타내는 그래프</li>
<li>정규분포인가? 중심적으로 봐야 함<ul>
<li>정규분포 : 평균 중심으로 좌우 대칭이 똑같은 그래프</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.displot(data = titanic, x =<span class="string">&#x27;age&#x27;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7ff99a226910&gt;
</code></pre>
<p><img src="/images/0706/output_8_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.displot(data = titanic, x = <span class="string">&#x27;age&#x27;</span>, kde = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7ff999f65d90&gt;
</code></pre>
<p><img src="/images/0706/output_9_1.png" alt="png"></p>
<h3 id="범주형-데이터-시각화"><a href="#범주형-데이터-시각화" class="headerlink" title="범주형 데이터 시각화"></a>범주형 데이터 시각화</h3><ul>
<li>x축 범주형, y축 수치데이터</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 막대 그래프</span></span><br><span class="line">sns.barplot(x = <span class="string">&#x27;class&#x27;</span>, y = <span class="string">&#x27;fare&#x27;</span>, data = titanic)</span><br><span class="line"><span class="comment"># 회색 막대기가 평균치, 위아래로 튀어나와 있는 정도를 error bar 오차막대 라고 한다.</span></span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999e93b50&gt;
</code></pre>
<p><img src="/images/0706/output_11_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 포인트 plot</span></span><br><span class="line">sns.pointplot(x = <span class="string">&#x27;class&#x27;</span>, y = <span class="string">&#x27;fare&#x27;</span>, data = titanic)</span><br><span class="line"><span class="comment"># 상황에 맞춰서 그래프 모형은 다르게 쓴다. 내용은 똑같음</span></span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999df6410&gt;
</code></pre>
<p><img src="/images/0706/output_12_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 박스 plot</span></span><br><span class="line">sns.boxplot(x = <span class="string">&#x27;class&#x27;</span>, y = <span class="string">&#x27;age&#x27;</span>, data = titanic)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999ddcbd0&gt;
</code></pre>
<p><img src="/images/0706/output_13_1.png" alt="png"></p>
<ul>
<li>박스 plot</li>
<li>제 1사분위 : 전체 데이터 중 하위 25%(박스 아랫변)</li>
<li>제 2사분위 : 25% ~ 50% (박스 중간)</li>
<li>제 3사분위 : 50% ~ 75% (박스 윗변)</li>
<li>사분위 범위 수(IQR) : 제 3사분위 - 제 1사분위</li>
<li>최댓값 : 제 3사분위 + (1.5 * IQ)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 바이올린 플롯</span></span><br><span class="line">sns.violinplot(x = <span class="string">&#x27;class&#x27;</span>, y = <span class="string">&#x27;age&#x27;</span>, hue = <span class="string">&#x27;sex&#x27;</span>, data = titanic, split = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999d09e10&gt;
</code></pre>
<p><img src="/images/0706/output_15_1.png" alt="png"></p>
<h4 id="카운트-plot"><a href="#카운트-plot" class="headerlink" title="카운트 plot"></a>카운트 plot</h4><ul>
<li>범주형 데이터의 갯수 확인 할 때 사용</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.countplot(x = <span class="string">&#x27;class&#x27;</span>, data = titanic)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999c9d290&gt;
</code></pre>
<p><img src="/images/0706/output_17_1.png" alt="png"></p>
<h2 id="데이터-관계-시각화"><a href="#데이터-관계-시각화" class="headerlink" title="데이터 관계 시각화"></a>데이터 관계 시각화</h2><ul>
<li>여러 데이터 사이의 관계도 파악 위한 그래프</li>
</ul>
<h3 id="히트맵"><a href="#히트맵" class="headerlink" title="히트맵"></a>히트맵</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flights= sns.load_dataset(<span class="string">&#x27;flights&#x27;</span>)</span><br><span class="line">flights.head()</span><br></pre></td></tr></table></figure>





  <div id="df-c3854d41-b9f5-448f-8697-3ef25f747e15">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>passengers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1949</td>
      <td>Jan</td>
      <td>112</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1949</td>
      <td>Feb</td>
      <td>118</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1949</td>
      <td>Mar</td>
      <td>132</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1949</td>
      <td>Apr</td>
      <td>129</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1949</td>
      <td>May</td>
      <td>121</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c3854d41-b9f5-448f-8697-3ef25f747e15')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-c3854d41-b9f5-448f-8697-3ef25f747e15 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-c3854d41-b9f5-448f-8697-3ef25f747e15&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<ul>
<li>각 연도별, 월별 승객 수 구하기</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flights[&#x27;year&#x27;].value_counts()</span></span><br><span class="line">flights_pivot = flights.pivot(index = <span class="string">&#x27;month&#x27;</span>, columns = <span class="string">&#x27;year&#x27;</span>, values = <span class="string">&#x27;passengers&#x27;</span>)</span><br><span class="line">flights_pivot</span><br></pre></td></tr></table></figure>





  <div id="df-e33832bd-f6d9-469d-92ff-6457ffffde82">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1949</th>
      <th>1950</th>
      <th>1951</th>
      <th>1952</th>
      <th>1953</th>
      <th>1954</th>
      <th>1955</th>
      <th>1956</th>
      <th>1957</th>
      <th>1958</th>
      <th>1959</th>
      <th>1960</th>
    </tr>
    <tr>
      <th>month</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jan</th>
      <td>112</td>
      <td>115</td>
      <td>145</td>
      <td>171</td>
      <td>196</td>
      <td>204</td>
      <td>242</td>
      <td>284</td>
      <td>315</td>
      <td>340</td>
      <td>360</td>
      <td>417</td>
    </tr>
    <tr>
      <th>Feb</th>
      <td>118</td>
      <td>126</td>
      <td>150</td>
      <td>180</td>
      <td>196</td>
      <td>188</td>
      <td>233</td>
      <td>277</td>
      <td>301</td>
      <td>318</td>
      <td>342</td>
      <td>391</td>
    </tr>
    <tr>
      <th>Mar</th>
      <td>132</td>
      <td>141</td>
      <td>178</td>
      <td>193</td>
      <td>236</td>
      <td>235</td>
      <td>267</td>
      <td>317</td>
      <td>356</td>
      <td>362</td>
      <td>406</td>
      <td>419</td>
    </tr>
    <tr>
      <th>Apr</th>
      <td>129</td>
      <td>135</td>
      <td>163</td>
      <td>181</td>
      <td>235</td>
      <td>227</td>
      <td>269</td>
      <td>313</td>
      <td>348</td>
      <td>348</td>
      <td>396</td>
      <td>461</td>
    </tr>
    <tr>
      <th>May</th>
      <td>121</td>
      <td>125</td>
      <td>172</td>
      <td>183</td>
      <td>229</td>
      <td>234</td>
      <td>270</td>
      <td>318</td>
      <td>355</td>
      <td>363</td>
      <td>420</td>
      <td>472</td>
    </tr>
    <tr>
      <th>Jun</th>
      <td>135</td>
      <td>149</td>
      <td>178</td>
      <td>218</td>
      <td>243</td>
      <td>264</td>
      <td>315</td>
      <td>374</td>
      <td>422</td>
      <td>435</td>
      <td>472</td>
      <td>535</td>
    </tr>
    <tr>
      <th>Jul</th>
      <td>148</td>
      <td>170</td>
      <td>199</td>
      <td>230</td>
      <td>264</td>
      <td>302</td>
      <td>364</td>
      <td>413</td>
      <td>465</td>
      <td>491</td>
      <td>548</td>
      <td>622</td>
    </tr>
    <tr>
      <th>Aug</th>
      <td>148</td>
      <td>170</td>
      <td>199</td>
      <td>242</td>
      <td>272</td>
      <td>293</td>
      <td>347</td>
      <td>405</td>
      <td>467</td>
      <td>505</td>
      <td>559</td>
      <td>606</td>
    </tr>
    <tr>
      <th>Sep</th>
      <td>136</td>
      <td>158</td>
      <td>184</td>
      <td>209</td>
      <td>237</td>
      <td>259</td>
      <td>312</td>
      <td>355</td>
      <td>404</td>
      <td>404</td>
      <td>463</td>
      <td>508</td>
    </tr>
    <tr>
      <th>Oct</th>
      <td>119</td>
      <td>133</td>
      <td>162</td>
      <td>191</td>
      <td>211</td>
      <td>229</td>
      <td>274</td>
      <td>306</td>
      <td>347</td>
      <td>359</td>
      <td>407</td>
      <td>461</td>
    </tr>
    <tr>
      <th>Nov</th>
      <td>104</td>
      <td>114</td>
      <td>146</td>
      <td>172</td>
      <td>180</td>
      <td>203</td>
      <td>237</td>
      <td>271</td>
      <td>305</td>
      <td>310</td>
      <td>362</td>
      <td>390</td>
    </tr>
    <tr>
      <th>Dec</th>
      <td>118</td>
      <td>140</td>
      <td>166</td>
      <td>194</td>
      <td>201</td>
      <td>229</td>
      <td>278</td>
      <td>306</td>
      <td>336</td>
      <td>337</td>
      <td>405</td>
      <td>432</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e33832bd-f6d9-469d-92ff-6457ffffde82')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-e33832bd-f6d9-469d-92ff-6457ffffde82 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-e33832bd-f6d9-469d-92ff-6457ffffde82&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.heatmap(data = flights_pivot)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999c0ff90&gt;
</code></pre>
<p><img src="/images/0706/output_23_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 라인플롯</span></span><br><span class="line">sns.lineplot(x = <span class="string">&#x27;year&#x27;</span>, y = <span class="string">&#x27;passengers&#x27;</span>, data = flights)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999bf9d90&gt;
</code></pre>
<p><img src="/images/0706/output_24_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 산점도</span></span><br><span class="line">tips = sns.load_dataset(<span class="string">&#x27;tips&#x27;</span>)</span><br><span class="line">tips.head()</span><br></pre></td></tr></table></figure>





  <div id="df-ca53f1d3-b076-478e-a68c-226957b2fa6b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ca53f1d3-b076-478e-a68c-226957b2fa6b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-ca53f1d3-b076-478e-a68c-226957b2fa6b button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-ca53f1d3-b076-478e-a68c-226957b2fa6b&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<ul>
<li>두개의 연속형 데이터</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.scatterplot(x = <span class="string">&#x27;total_bill&#x27;</span>, y = <span class="string">&#x27;tip&#x27;</span>, hue = <span class="string">&#x27;sex&#x27;</span>, data = tips)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999b3ab10&gt;
</code></pre>
<p><img src="/images/0706/output_27_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 회귀선</span></span><br><span class="line">sns.regplot(x = <span class="string">&#x27;total_bill&#x27;</span>, y = <span class="string">&#x27;tip&#x27;</span>, data = tips)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff999f45350&gt;
</code></pre>
<p><img src="/images/0706/output_28_1.png" alt="png"></p>
<h2 id="머신러닝-리뷰"><a href="#머신러닝-리뷰" class="headerlink" title="머신러닝 리뷰"></a>머신러닝 리뷰</h2><ul>
<li>가장 인기 있는 모델<ul>
<li>LightGBM, XGboost</li>
</ul>
</li>
</ul>
<h3 id="선형-회귀"><a href="#선형-회귀" class="headerlink" title="선형 회귀"></a>선형 회귀</h3><ul>
<li>선형 회귀식을 찾는 것이 중요</li>
<li>$y &#x3D; 3x + 4$ 에 근사한 데이터 50개 생성</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 시드값 고정</span></span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line">intercept = <span class="number">4</span>  <span class="comment"># 절편, 상수</span></span><br><span class="line">slope = <span class="number">3</span>  <span class="comment"># 기울기</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 변동성 주기 위해 노이즈를 생성</span></span><br><span class="line">noise = np.random.randn(<span class="number">50</span>, <span class="number">1</span>)</span><br><span class="line">x = <span class="number">5</span> * np.random.rand(<span class="number">50</span>, <span class="number">1</span>)  <span class="comment"># 0 과 5 사이의 실숫값 50개 생성</span></span><br><span class="line">y = slope * x + intercept + noise</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터 프레임 생성</span></span><br><span class="line">data = pd.DataFrame(&#123;<span class="string">&#x27;X&#x27;</span> : x[:, <span class="number">0</span>], <span class="string">&#x27;Y&#x27;</span> : y[:, <span class="number">0</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>

<pre><code>           X          Y
0   0.794848   8.148596
1   0.551876   6.055784
2   3.281648  14.823682
3   0.690915   8.313637
4   0.982912   8.816293
5   1.843626   8.553600
6   4.104966  17.264987
7   0.485506   5.305162
8   4.189725  16.465955
9   0.480492   5.852075
10  4.882297  18.790936
11  2.343256  12.484042
12  4.883805  19.412454
13  3.024228  13.194358
14  3.696318  15.532817
15  0.195939   4.921491
16  1.414035   9.736184
17  0.600983   5.597790
18  1.480701   8.755171
19  0.593639   4.926820
20  1.589916   6.216758
21  2.071315  10.867564
22  0.320737   5.826649
23  3.462361  13.644917
24  2.833007  14.768776
25  1.326947   6.526477
26  2.616240  11.894479
27  0.469703   5.221924
28  2.879732  14.171977
29  4.646481  19.408802
30  1.592845   8.933482
31  3.337052  14.389318
32  0.658989   5.089182
33  3.581636  12.764112
34  1.447030   7.993179
35  0.915957   6.904219
36  2.932565  14.027985
37  0.100538   5.503993
38  4.144700  16.046774
39  0.023477   3.768129
40  3.389083  13.118695
41  1.350040   6.630102
42  3.675970  13.321640
43  4.810943  20.383604
44  1.243766   7.221645
45  2.880787  12.204286
46  2.960210  11.627834
47  2.861260  13.361269
48  1.115408   5.732327
49  4.763745  18.078495
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.scatter(data[<span class="string">&#x27;X&#x27;</span>], data[<span class="string">&#x27;Y&#x27;</span>])</span><br><span class="line">plt.show</span><br></pre></td></tr></table></figure>




<pre><code>&lt;function matplotlib.pyplot.show&gt;
</code></pre>
<p><img src="/images/0706/output_32_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns </span><br><span class="line">sns.scatterplot(x = <span class="string">&#x27;X&#x27;</span>, y = <span class="string">&#x27;Y&#x27;</span>, data = data)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff99996ef10&gt;
</code></pre>
<p><img src="/images/0706/output_33_1.png" alt="png"></p>
<h4 id="선형회귀-모형-훈련"><a href="#선형회귀-모형-훈련" class="headerlink" title="선형회귀 모형 훈련"></a>선형회귀 모형 훈련</h4><ul>
<li>모형 생성 후, 회귀계수 3과 y절편 4에 근사한 값이 나와야 함</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">lr_model = LinearRegression()   <span class="comment"># 선형 회귀 모델</span></span><br><span class="line">lr_model.fit(x, y)    <span class="comment"># 모델 훈련</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;y절편:&#x27;</span>, lr_model.intercept_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;회귀계수:&#x27;</span>, lr_model.coef_)</span><br></pre></td></tr></table></figure>

<pre><code>y절편: [4.05757639]
회귀계수: [[3.03754061]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 예측값</span></span><br><span class="line">y_pred = lr_model.predict(x)</span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.scatter(x, y)</span><br><span class="line">ax.plot(x, y_pred, color=<span class="string">&#x27;green&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># slope, intercept </span></span><br><span class="line">label = <span class="string">&#x27;slope: &#123;&#125;\nintercept: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">round</span>(lr_model.coef_[<span class="number">0</span>][<span class="number">0</span>], <span class="number">2</span>), <span class="built_in">round</span>(lr_model.intercept_[<span class="number">0</span>], <span class="number">2</span>))</span><br><span class="line">ax.text(<span class="number">3.5</span>, <span class="number">4</span>, label, style =<span class="string">&#x27;italic&#x27;</span>, </span><br><span class="line">        fontsize = <span class="number">10</span>, color =<span class="string">&quot;green&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/0706/output_36_0.png" alt="png"></p>
<h3 id="로지스틱-회귀"><a href="#로지스틱-회귀" class="headerlink" title="로지스틱 회귀"></a>로지스틱 회귀</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sigmoid</span>(<span class="params">arr, scale=<span class="number">1</span></span>):</span><br><span class="line">    arr = np.asarray(arr)</span><br><span class="line">    result = <span class="number">1</span>/(<span class="number">1</span> + np.exp(-arr*scale))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">x = np.linspace(-<span class="number">6</span>, <span class="number">6</span>)</span><br><span class="line">y = sigmoid(x)</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.plot(x, y)</span><br><span class="line">ax.grid(which=<span class="string">&#x27;major&#x27;</span>, axis=<span class="string">&#x27;y&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">ax.axvline(x=<span class="number">0</span>, color=<span class="string">&#x27;r&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, linewidth=<span class="number">1</span>)</span><br><span class="line">ax.set_ylim(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">ax.set_yticks([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0.5</span>])</span><br><span class="line">ax.text(<span class="number">0</span>-<span class="number">0.1</span>, <span class="number">0.5</span>, <span class="string">&#x27;0.5&#x27;</span>, ha=<span class="string">&#x27;right&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;Sigmoid Graph&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/0706/output_38_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 라이브러리 불러오기</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, confusion_matrix</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터 가져오기</span></span><br><span class="line">x = np.arange(<span class="number">10</span>).reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">y = np.array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모델 생성 및 학습</span></span><br><span class="line">model = LogisticRegression(solver=<span class="string">&#x27;liblinear&#x27;</span>, C=<span class="number">10.0</span>, random_state=<span class="number">0</span>)</span><br><span class="line">model.fit(x, y)</span><br></pre></td></tr></table></figure>




<pre><code>LogisticRegression(C=10.0, random_state=0, solver=&#39;liblinear&#39;)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 모형 평가</span></span><br><span class="line">p_pred = model.predict_proba(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p_pred&#x27;</span>, p_pred, sep = <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<pre><code>p_pred
[[0.97979027 0.02020973]
 [0.94958202 0.05041798]
 [0.87976149 0.12023851]
 [0.73975066 0.26024934]
 [0.52477284 0.47522716]
 [0.30020373 0.69979627]
 [0.1428487  0.8571513 ]
 [0.06080627 0.93919373]
 [0.02453462 0.97546538]
 [0.00967652 0.99032348]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_pred = model.predict(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;y_pred&#x27;</span>, y_pred)</span><br></pre></td></tr></table></figure>

<pre><code>y_pred [0 0 0 0 0 1 1 1 1 1]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.scatter(x, y)</span><br><span class="line">ax.plot(x, p_pred[:, <span class="number">1</span>], color = <span class="string">&#x27;black&#x27;</span>,  marker=<span class="string">&#x27;o&#x27;</span>, markersize=<span class="number">6</span>)</span><br><span class="line">ax.plot()</span><br><span class="line"></span><br><span class="line">ax.set_xticks(x)</span><br><span class="line">ax.set_yticks(np.arange(<span class="number">0</span>, <span class="number">1.1</span>, <span class="number">0.1</span>))</span><br><span class="line"></span><br><span class="line">ax.grid(which=<span class="string">&#x27;major&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/0706/output_42_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conf_m = confusion_matrix(y, y_pred)</span><br><span class="line"><span class="built_in">print</span>(conf_m)</span><br></pre></td></tr></table></figure>

<pre><code>[[5 0]
 [0 5]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cm = confusion_matrix(y, y_pred)</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line">ax.imshow(cm, cmap = <span class="string">&#x27;Pastel2&#x27;</span>)</span><br><span class="line">ax.grid(<span class="literal">False</span>)</span><br><span class="line">ax.xaxis.<span class="built_in">set</span>(ticks=(<span class="number">0</span>, <span class="number">1</span>), ticklabels=(<span class="string">&#x27;Predicted 0&#x27;</span>, <span class="string">&#x27;Predicted 1&#x27;</span>))</span><br><span class="line">ax.yaxis.<span class="built_in">set</span>(ticks=(<span class="number">0</span>, <span class="number">1</span>), ticklabels=(<span class="string">&#x27;Actual 0&#x27;</span>, <span class="string">&#x27;Actual 1&#x27;</span>))</span><br><span class="line">ax.set_ylim(<span class="number">1.5</span>, -<span class="number">0.5</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        ax.text(j, i, cm[i, j], ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/0706/output_44_0.png" alt="png"></p>
<h2 id="결정-트리"><a href="#결정-트리" class="headerlink" title="결정 트리"></a>결정 트리</h2><ul>
<li>분류와 회귀 문제에 모두 사용 가능</li>
</ul>
<h3 id="주요-개념"><a href="#주요-개념" class="headerlink" title="주요 개념"></a>주요 개념</h3><ul>
<li>작동 원리<ul>
<li>데이터를 가장 잘 구분하는 조건을 정함.</li>
<li>조건을 기준으로 데이터를 두 범주로 나눔</li>
<li>나뉜 각 범주의 데이터를 구분하는 조건을 정함</li>
<li>각 조건을 기준으로 데이터를 두 범주로 나눔</li>
<li>언제까지 계속 분할할지 정한 후, 최종 결정 값을 구함.</li>
</ul>
</li>
<li>불순도(Impurity)<ul>
<li>한 범주 안에 서로 다른 데이터가 얼마나 섞여 있는지 나타냄</li>
<li>흰색과 검은색이 50:50으로 섞여 있다. (불순도 최대)</li>
<li>흰색과 검은색으로 완전 분리 되었다. (불순도 최소)</li>
</ul>
</li>
<li>엔트로피(Entropy)<ul>
<li>불확실한 정도를 의미함. 0 ~ 1로 정함.</li>
<li>흰색과 검은색이 50:50으로 섞여 있다. 엔트로피 1</li>
<li>흰색과 검은색으로 완전 분리 되었다. 엔트로피 0</li>
</ul>
</li>
<li>정보이득(Information Gain)<ul>
<li>1에서 엔트로피를 뺀 수치</li>
<li>정보 이득을 최대화하는 방향(엔트로피를 최소화 하는 방향)으로 노드를 분할함</li>
</ul>
</li>
<li>지니 불순도(Gini Impurity)<ul>
<li>지니 불순도 값이 클수록 불순도도 높고, 작을수록 불순도도 낮음. 엔트로피와 마찬가지로 지니 불순도가 낮아지는 방향으로 노드 분할함.</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split </span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns </span><br><span class="line"></span><br><span class="line"><span class="comment"># tips 데이터셋 </span></span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>)</span><br><span class="line">titanic.info()</span><br></pre></td></tr></table></figure>

<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 15 columns):
 #   Column       Non-Null Count  Dtype   
---  ------       --------------  -----   
 0   survived     891 non-null    int64   
 1   pclass       891 non-null    int64   
 2   sex          891 non-null    object  
 3   age          714 non-null    float64 
 4   sibsp        891 non-null    int64   
 5   parch        891 non-null    int64   
 6   fare         891 non-null    float64 
 7   embarked     889 non-null    object  
 8   class        891 non-null    category
 9   who          891 non-null    object  
 10  adult_male   891 non-null    bool    
 11  deck         203 non-null    category
 12  embark_town  889 non-null    object  
 13  alive        891 non-null    object  
 14  alone        891 non-null    bool    
dtypes: bool(2), category(2), float64(2), int64(4), object(5)
memory usage: 80.7+ KB
</code></pre>
<ul>
<li>survived의 비율을 구한다.<ul>
<li>0 : 사망자</li>
<li>1 : 생존자</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic[<span class="string">&#x27;survived&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>0    549
1    342
Name: survived, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 데이터 추출</span></span><br><span class="line">X = titanic[[<span class="string">&#x27;pclass&#x27;</span>, <span class="string">&#x27;parch&#x27;</span>, <span class="string">&#x27;fare&#x27;</span>]]</span><br><span class="line">y = titanic[<span class="string">&#x27;survived&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 훈련데이터, 테스트 데이터 분리</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, stratify = y, test_size = <span class="number">0.3</span>, random_state=<span class="number">42</span>)</span><br><span class="line">X_train.shape, X_test.shape, y_train.shape, y_test.shape</span><br></pre></td></tr></table></figure>




<pre><code>((623, 3), (268, 3), (623,), (268,))
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tree_model = DecisionTreeClassifier()</span><br><span class="line">tree_model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">acc = tree_model.score(X_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;모형 정확도 : <span class="subst">&#123;acc:<span class="number">.3</span>f&#125;</span>&#x27;</span>) <span class="comment"># 정확도 측정</span></span><br></pre></td></tr></table></figure>

<pre><code>모형 정확도 : 0.675
</code></pre>
<h3 id="랜덤-포레스트"><a href="#랜덤-포레스트" class="headerlink" title="랜덤 포레스트"></a>랜덤 포레스트</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split </span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns </span><br><span class="line"></span><br><span class="line"><span class="comment"># tips 데이터셋 </span></span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = titanic[[<span class="string">&#x27;pclass&#x27;</span>, <span class="string">&#x27;parch&#x27;</span>, <span class="string">&#x27;fare&#x27;</span>]]</span><br><span class="line">y = titanic[<span class="string">&#x27;survived&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 훈련데이터, 테스트 데이터 분리</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, stratify = y, test_size = <span class="number">0.3</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모델 훈련</span></span><br><span class="line">rf_model = RandomForestClassifier(random_state=<span class="number">42</span>) <span class="comment"># 랜덤 포레스트 정의</span></span><br><span class="line">rf_model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">acc = rf_model.score(X_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;모형 정확도 : <span class="subst">&#123;acc:<span class="number">.3</span>f&#125;</span>&#x27;</span>) <span class="comment"># 정확도 측정</span></span><br></pre></td></tr></table></figure>

<pre><code>모형 정확도 : 0.675
</code></pre>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/07/07/lecture-in-humanedu/"
                    data-tooltip="kaggle 과제"
                    aria-label="이전: kaggle 과제"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/07/05/PyCaret_Sample%20(1)/"
                    data-tooltip="PyCaret(함수자동생성기 세팅)"
                    aria-label="다음: PyCaret(함수자동생성기 세팅)"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://neewlife.github.io/2022/07/06/day0706_1/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://neewlife.github.io/2022/07/06/day0706_1/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://neewlife.github.io/2022/07/06/day0706_1/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#gitment"
                        aria-label="댓글을 남겨주세요"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="gitment"></div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2023 오세영. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/07/07/lecture-in-humanedu/"
                    data-tooltip="kaggle 과제"
                    aria-label="이전: kaggle 과제"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/07/05/PyCaret_Sample%20(1)/"
                    data-tooltip="PyCaret(함수자동생성기 세팅)"
                    aria-label="다음: PyCaret(함수자동생성기 세팅)"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://neewlife.github.io/2022/07/06/day0706_1/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://neewlife.github.io/2022/07/06/day0706_1/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://neewlife.github.io/2022/07/06/day0706_1/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#gitment"
                        aria-label="댓글을 남겨주세요"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://neewlife.github.io/2022/07/06/day0706_1/"
                        aria-label="Facebook에 공유하기"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://neewlife.github.io/2022/07/06/day0706_1/"
                        aria-label="Twitter에 공유하기"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://neewlife.github.io/2022/07/06/day0706_1/"
                        aria-label="Google+에 공유하기"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Google+에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">오세영</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    
        
<script src="/assets/js/gitment.js"></script>

        <script type="text/javascript">
          (function() {
            new Gitment({
              id: 'https://neewlife.github.io/2022/07/06/day0706_1/',
              owner: '',
              repo: '',
              oauth: {
                client_id: '',
                client_secret: ''
              }
            }).render('gitment')
          })()
        </script>
    




    </body>
</html>
