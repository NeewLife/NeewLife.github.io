
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="개발 메모장">
    <title>day 0701_ch4 - 개발 메모장</title>
    <meta name="author" content="오세영">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"오세영","sameAs":[],"image":"https://www.gravatar.com/avatar/54b39dd7beade1e993c6b9047cc1a4f4"},"articleBody":"로지스틱 회귀\n\n\n선형 회귀에서 출발\n이진 분류 문제 해결\n클래스 확률 예측\n딥러닝에서도 사용됨\n\n교재 177p\nX가 사각형일 확률 30%\nX가 삼각형일 확률  확률 20%50%\nX가 원일\n\n데이터 불러오기\nSpecies (종속변수&#x3D;Y)\n나머지 Weight, Length, Diagonal, Height, Width 는 독립변수\n\n1234import pandas as pdfish = pd.read_csv(&#x27;https://bit.ly/fish_csv_data&#x27;)fish.head()\n\n\n\n\n\n  \n    \n      \n\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n\n\n\n  \n    \n      \n      Species\n      Weight\n      Length\n      Diagonal\n      Height\n      Width\n    \n  \n  \n    \n      0\n      Bream\n      242.0\n      25.4\n      30.0\n      11.5200\n      4.0200\n    \n    \n      1\n      Bream\n      290.0\n      26.3\n      31.2\n      12.4800\n      4.3056\n    \n    \n      2\n      Bream\n      340.0\n      26.5\n      31.1\n      12.3778\n      4.6961\n    \n    \n      3\n      Bream\n      363.0\n      29.0\n      33.5\n      12.7300\n      4.4555\n    \n    \n      4\n      Bream\n      430.0\n      29.0\n      34.0\n      12.4440\n      5.1340\n    \n  \n\n\n      \n\n  &lt;svg xmlns&#x3D;”http://www.w3.org/2000/svg“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”       width&#x3D;”24px”&gt;                \n  \n    .colab-df-container {\n      display:flex;\n      flex-wrap:wrap;\n      gap: 12px;\n    }\n\n    .colab-df-convert {\n      background-color: #E8F0FE;\n      border: none;\n      border-radius: 50%;\n      cursor: pointer;\n      display: none;\n      fill: #1967D2;\n      height: 32px;\n      padding: 0 0 0 0;\n      width: 32px;\n    }\n\n    .colab-df-convert:hover {\n      background-color: #E2EBFA;\n      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n      fill: #174EA6;\n    }\n\n    [theme=dark] .colab-df-convert {\n      background-color: #3B4455;\n      fill: #D2E3FC;\n    }\n\n    [theme=dark] .colab-df-convert:hover {\n      background-color: #434B5C;\n      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n      fill: #FFFFFF;\n    }\n  \n\n  &lt;script&gt;\n    const buttonEl =\n      document.querySelector(&#39;#df-4733cf17-6355-45a1-8704-1092d897ce3b button.colab-df-convert&#39;);\n    buttonEl.style.display =\n      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;\n\n    async function convertToInteractive(key) &#123;\n      const element = document.querySelector(&#39;#df-4733cf17-6355-45a1-8704-1092d897ce3b&#39;);\n      const dataTable =\n        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,\n                                                 [key], &#123;&#125;);\n      if (!dataTable) return;\n\n      const docLinkHtml = &#39;Like what you see? Visit the &#39; +\n        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;\n        + &#39; to learn more about interactive tables.&#39;;\n      element.innerHTML = &#39;&#39;;\n      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;\n      await google.colab.output.renderOutput(dataTable, element);\n      const docLink = document.createElement(&#39;div&#39;);\n      docLink.innerHTML = docLinkHtml;\n      element.appendChild(docLink);\n    &#125;\n  &lt;/script&gt;\n&lt;/div&gt;\n\n  \n\n\n\n\n데이터 탐색123# 가장 신경써야 하는건 종속변수print(pd.unique(fish[&#x27;Species&#x27;]))print(fish[&#x27;Species&#x27;].value_counts())\n\n[&#39;Bream&#39; &#39;Roach&#39; &#39;Whitefish&#39; &#39;Parkki&#39; &#39;Perch&#39; &#39;Pike&#39; &#39;Smelt&#39;]\nPerch        56\nBream        35\nRoach        20\nPike         17\nSmelt        14\nParkki       11\nWhitefish     6\nName: Species, dtype: int64\n\n데이터 가공123# pandas 데이터 프레임에서 numpy 배열로 변환fish_input = fish[[&#x27;Weight&#x27;, &#x27;Length&#x27;, &#x27;Diagonal&#x27;, &#x27;Height&#x27;, &#x27;Width&#x27;]].to_numpy()print(fish_input.shape)\n\n(159, 5)\n\n1print(fish_input[:5])\n\n[[242.      25.4     30.      11.52     4.02  ]\n [290.      26.3     31.2     12.48     4.3056]\n [340.      26.5     31.1     12.3778   4.6961]\n [363.      29.      33.5     12.73     4.4555]\n [430.      29.      34.      12.444    5.134 ]]\n\n\n타깃 데이터 &#x3D; 종속변수 &#x3D; Y\n\n123fish_target = fish[&#x27;Species&#x27;].to_numpy()print(fish_target.shape)print(fish_target[:5])\n\n(159,)\n[&#39;Bream&#39; &#39;Bream&#39; &#39;Bream&#39; &#39;Bream&#39; &#39;Bream&#39;]\n\n데이터 분리\n훈련데이터 테스트 데이터 분리\n\n12345678from sklearn.model_selection import train_test_split# 임의 샘플링train_input, test_input, train_target, test_target = train_test_split(    fish_input, fish_target, random_state=42)# 층화 샘플링\n\n표준화 전처리(중요)\n여기에서도 훈련 세트의 통계값으로 테스트 세트를 변환해야 한다.\n데이터 세트를 나눴을 때 100개의 데이터중 70개는 훈련 세트 데이터, 30개는 테스트 데이터 일 수도 있는데, 테스트를 할때 테스트 데이터를 넣고 돌리면 답지 보고 수능 푸는 격이기 때문에, 우리는 테스트 데이터를 알지만 훈련 데이터 값으로 테스트를 해야 옳은 테스트 이다.\n\n\n예) 데이터 가공 할때\n숫자 결측치가 존재, 훈련데이터의 평균값으로 대체 해야 한다.(테스트 데이터의 결측치도 훈련데이터의 평균값으로)\n전체데이터의 평균값으로 넣으면 X\n따라서 훈련 데이터와 테스트 데이터는 분리 해야한다\n\n\n이 작업을 “데이터 누수(Data Leakage)” 라고 한다\n훈련 데이터 평균값 70을 대치\n테스트 데이터 평균값 75를 대치\n모든 데이터 평균값 73을 대치\n이 중 뭐가 옳을까?\n답 : 70\n\n\n\n\n\n교재 97p.\n\n기준을 맞춰라 –&gt; 데이터 표준화 (표준점수)\n수동으로 mean, std\n표준점수 &#x3D; (데이터 - 평균) &#x2F; 분산 -&gt; ss.transform(tranin_input) 으로 한방에 처리\n\n1234567from sklearn.preprocessing import StandardScalerss = StandardScaler()ss.fit(train_input)# ss.fit(test_input) =&gt; 이 코드는 쓰면 안된다!! 테스트 데이터값은 쓰지 않는다.train_scaled = ss.transform(train_input)test_scaled = ss.transform(test_input)\n\n모형 만들기\nK-최근접 이웃\n\n123456from sklearn.neighbors import KNeighborsClassifierkn = KNeighborsClassifier(n_neighbors = 3)kn.fit(train_scaled, train_target)print(kn.score(train_scaled, train_target))print(kn.score(test_scaled, test_target))\n\n0.8907563025210085\n0.85\n\n\n타깃값 확인\n알파벳 순으로 정렬\n\n1print(kn.classes_)\n\n[&#39;Bream&#39; &#39;Parkki&#39; &#39;Perch&#39; &#39;Pike&#39; &#39;Roach&#39; &#39;Smelt&#39; &#39;Whitefish&#39;]\n\n\n다중분류\n\n1print(kn.predict(test_scaled[:5]))\n\n[&#39;Perch&#39; &#39;Smelt&#39; &#39;Pike&#39; &#39;Perch&#39; &#39;Perch&#39;]\n\n\n5개 항목의 확률\n\n1234import numpy as npproba = kn.predict_proba(test_scaled[:5])print (kn.classes_)print(np.round(proba, decimals=4))\n\n[&#39;Bream&#39; &#39;Parkki&#39; &#39;Perch&#39; &#39;Pike&#39; &#39;Roach&#39; &#39;Smelt&#39; &#39;Whitefish&#39;]\n[[0.     0.     1.     0.     0.     0.     0.    ]\n [0.     0.     0.     0.     0.     1.     0.    ]\n [0.     0.     0.     1.     0.     0.     0.    ]\n [0.     0.     0.6667 0.     0.3333 0.     0.    ]\n [0.     0.     0.6667 0.     0.3333 0.     0.    ]]\n\n\n첫번째 클래스\nPerch로 분류할 확률이 100%\n\n\n두번째 클래스\nPerch로 분류할 확률이 66.7%\nRoach로 분류할 확률이 33.3%\n\n\n\n회귀 식\ny &#x3D; ax + b\n양변에 로그를 취함\n\n로지스틱 회귀로 이진 분류 수행하기123char_arr = np.array([&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;])  # train_scaled 값# [True, False, True, False, False] --&gt; bream_smelt_indexesprint(char_arr[[True, False, True, False, False]])\n\n[&#39;A&#39; &#39;C&#39;]\n\n\nTrue 값만 추출하는 원리를 이용해서\n이 원리를 이용해서 도미와 빙어의 행만 골라보자\n\n123456bream_smelt_indexes = (train_target == &#x27;Bream&#x27;) | (train_target == &#x27;Smelt&#x27;)train_bream_smelt = train_scaled[bream_smelt_indexes]target_bream_smelt = train_target[bream_smelt_indexes]train_scaled.shape, train_bream_smelt.shape# 119개에서 33개로 줄어든 데이터\n\n\n\n\n((119, 5), (33, 5))\n\n모델 만들기123from sklearn.linear_model import LogisticRegressionlr = LogisticRegression()lr.fit(train_bream_smelt, target_bream_smelt)\n\n\n\n\nLogisticRegression()\n\n12# 클래스를 예측print(lr.predict(train_bream_smelt[:5]))\n\n[&#39;Bream&#39; &#39;Smelt&#39; &#39;Bream&#39; &#39;Bream&#39; &#39;Bream&#39;]\n\n\n확률 값 구하기\n\n1print(lr.predict_proba(train_bream_smelt[:5]))\n\n[[0.99759855 0.00240145]\n [0.02735183 0.97264817]\n [0.99486072 0.00513928]\n [0.98584202 0.01415798]\n [0.99767269 0.00232731]]\n\n12print(lr.classes_)# 왼쪽이 Bream 오른쪽이 Smelt\n\n[&#39;Bream&#39; &#39;Smelt&#39;]\n\n\n분류기준 : threshold 임계값 설정 (꼭 0.5일 필요는 없다)\n\n도미 vs 빙어\n[0.49, 0.51],\n[0.70, 0.30],\n[0.90, 0.10]\n계수와 절편1print(lr.coef_, lr.intercept_)\n\n[[-0.4037798  -0.57620209 -0.66280298 -1.01290277 -0.73168947]] [-2.16155132]\n\n12decisions = lr.decision_function(train_bream_smelt[:5])print(decisions)\n\n[-6.02927744  3.57123907 -5.26568906 -4.24321775 -6.0607117 ]\n\n\n이 z 값을 확률 값으로 변환(z값을 평면에 떨어뜨린다)\n로지스틱 회귀 그래프 원리(직선그래프보다 매끄럽게 이어지는 그래프를 만듬)\n\n12from scipy.special import expitprint(expit(decisions))\n\n[0.00240145 0.97264817 0.00513928 0.01415798 0.00232731]\n\n다중 분류 수행하기\n이진 분류의 확장판\n\n12345678# 하이퍼 파라미터 세팅# 모형을 튜닝# 웬만하면 순정(default) 쓰세요.# 모형 결과의 과대적합 또는 과소적합을 방지 하기 위한 것lr = LogisticRegression(C = 20, max_iter = 1000)lr.fit(train_scaled, train_target)print(lr.score(train_scaled, train_target))print(lr.score(test_scaled, test_target))\n\n0.9327731092436975\n0.925\n\n1print(lr.predict(test_scaled[:5]))\n\n[&#39;Perch&#39; &#39;Smelt&#39; &#39;Pike&#39; &#39;Roach&#39; &#39;Perch&#39;]\n\n123proba = lr.predict_proba(test_scaled[:5])print(np.round(proba,decimals = 3))print(lr.classes_)\n\n[[0.    0.014 0.841 0.    0.136 0.007 0.003]\n [0.    0.003 0.044 0.    0.007 0.946 0.   ]\n [0.    0.    0.034 0.935 0.015 0.016 0.   ]\n [0.011 0.034 0.306 0.007 0.567 0.    0.076]\n [0.    0.    0.904 0.002 0.089 0.002 0.001]]\n[&#39;Bream&#39; &#39;Parkki&#39; &#39;Perch&#39; &#39;Pike&#39; &#39;Roach&#39; &#39;Smelt&#39; &#39;Whitefish&#39;]\n\n\n다중 분류일 경우 선형 방정식은 어떤 모습일까?\n7개 분류, 5개 컬럼 값에 선형 방정식\n\n\n\n1print(lr.coef_.shape, lr.intercept_.shape)  \n\n(7, 5) (7,)\n\n평가지표회귀 평가지표\n결정계수 (교재 121p)\n1 - (타깃 - 예측)^2의 합 &#x2F; (타깃 - 평균)^2의 합\n\n\nmae, mse, rmse 만 기억\n(실제 - 예측) &#x3D; 오차\nmae(mean absolute error) : 오차의 절댓값의 평균\nmse(mean squared error) : 오차 제곱의 평균\nrmse(root mean squared error) : mse에 제곱근을 취한 값\n\n\n좋은 모델의 기준\n결정계수 : 1에 수렴하면 좋은 모델\nmae, msem, rmse : 0에 수렴하면 좋은 모델\n\n\n\n123456789101112131415161718192021import numpy as npfrom sklearn.metrics import mean_absolute_error, mean_squared_error, r2_scoretrue = np.array([1, 2, 3, 2, 3, 5, 4, 6, 5, 6, 7, 8, 8]) # 실제값preds = np.array([1, 1, 2, 2, 3, 4, 4, 5, 5, 7, 7, 6, 8]) # 예측값# 절댓값 오차의 평균mae = mean_absolute_error(true, preds)print(mae)# 제곱 오차의 평균mse = mean_squared_error(true,preds)print(mse)# np.squt : 루트 씌워주는 함수rmse = np.sqrt(mse)print(rmse)# 결정계수r2 = r2_score(true, preds)print(r2)\n\n0.5384615384615384\n0.6923076923076923\n0.8320502943378437\n0.8617021276595744\n\n분류 평가지표\n오차 행렬\n실제 값\n[빙어, 도미, 도미, 빙어, 도미]\n\n\n예측 값\n[빙어, 빙어, 도미, 빙어, 빙어]\n\n\n\nTP(빙어를 빙어로 예측) &#x3D; 2개TN(도미를 도미로 예측) &#x3D; 1개FN(도미를 빙어로 예측) &#x3D; 2개FP(빙어를 도미로 예측) &#x3D; 0개\n\nTP, TN, FP, FN\n\n예) TP &#x3D; 5, TN &#x3D; 5, FP &#x3D; 3, FN &#x3D; 7\n\n모든 케이스에서 정확도로 처리할 수 없으므로 정밀도, 재현율 파악도 중요하다.\n\n정확도 : 전체 중에 맞춘 갯수\n\n(TP + TN) &#x2F; (TP + TN + FP + FN)\n\n\n정밀도 : 양성(Positive)이라고 예측한 값 중 실제 양성인 값의 비율\n\nTP &#x2F; (TP + FP)\n\n\n재현율 : 양성(Positive)인 실제 값 중 양성으로 예측한 값(TP)의 비율(암진단 같은 경우)\n\nTP &#x2F; (TP + TF)\n\n\n로그손실\n\nROC Curve (&#x3D; AUC)\n\n\n\n이 모형의 정확도 3&#x2F;5 &#x3D; 60%\n\n\n123456from sklearn.metrics import confusion_matrixtrue = [0,1,1,0,0]preds = [1,0,0,0,0]confusion_matrix(true, preds)\n\n\n\n\narray([[2, 1],\n       [2, 0]])\n\n","dateCreated":"2022-07-01T17:50:55+09:00","dateModified":"2022-07-21T21:49:42+09:00","datePublished":"2022-07-01T17:50:55+09:00","description":"로지스틱 회귀","headline":"day 0701_ch4","image":["python.png"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://neewlife.github.io/2022/07/01/day0701_ch04/"},"publisher":{"@type":"Organization","name":"오세영","sameAs":[],"image":"https://www.gravatar.com/avatar/54b39dd7beade1e993c6b9047cc1a4f4","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/54b39dd7beade1e993c6b9047cc1a4f4"}},"url":"https://neewlife.github.io/2022/07/01/day0701_ch04/","thumbnailUrl":"python.png"}</script>
    <meta name="description" content="로지스틱 회귀">
<meta property="og:type" content="blog">
<meta property="og:title" content="day 0701_ch4">
<meta property="og:url" content="https://neewlife.github.io/2022/07/01/day0701_ch04/index.html">
<meta property="og:site_name" content="개발 메모장">
<meta property="og:description" content="로지스틱 회귀">
<meta property="og:locale" content="ko_KR">
<meta property="og:image" content="https://neewlife.github.io/images/0701/logic.png">
<meta property="article:published_time" content="2022-07-01T08:50:55.000Z">
<meta property="article:modified_time" content="2022-07-21T12:49:42.118Z">
<meta property="article:author" content="오세영">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://neewlife.github.io/images/0701/logic.png">
    
    
        
    
    
    
        <meta property="og:image" content="https://NeewLife.github.io/2022/07/01/day0701_ch04/python.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://NeewLife.github.io/2022/07/01/day0701_ch04/python.png"/>
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-cmzshscwd70umjgsmxdtieulebe8dy2kz4v9dny3n7k7ghgigzcwws96nkfq.min.css">

    <!--STYLES END-->
    

    

    
        
            
<link rel="stylesheet" href="/assets/css/gitment.css">

        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="3">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            개발 메모장
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="링크 열기: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="3">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="카테고리"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="태그"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="아카이브"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/NeewLife?tab=repositories/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="3"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-center">
    
        <h1 class="post-title">
            day 0701_ch4
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2022-07-01T17:50:55+09:00">
	
		    2022/07/01
    	
    </time>
    
        <span>카테고리 </span>
        
    <a class="category-link" href="/categories/Python/">Python</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h3 id="로지스틱-회귀"><a href="#로지스틱-회귀" class="headerlink" title="로지스틱 회귀"></a>로지스틱 회귀</h3><span id="more"></span>

<ul>
<li>선형 회귀에서 출발</li>
<li>이진 분류 문제 해결</li>
<li>클래스 확률 예측</li>
<li>딥러닝에서도 사용됨</li>
</ul>
<h2 id="교재-177p"><a href="#교재-177p" class="headerlink" title="교재 177p"></a>교재 177p</h2><ul>
<li>X가 사각형일 확률 30%</li>
<li>X가 삼각형일 확률  확률 20%50%</li>
<li>X가 원일</li>
</ul>
<h2 id="데이터-불러오기"><a href="#데이터-불러오기" class="headerlink" title="데이터 불러오기"></a>데이터 불러오기</h2><ul>
<li>Species (종속변수&#x3D;Y)</li>
<li>나머지 Weight, Length, Diagonal, Height, Width 는 독립변수</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">fish = pd.read_csv(<span class="string">&#x27;https://bit.ly/fish_csv_data&#x27;</span>)</span><br><span class="line">fish.head()</span><br></pre></td></tr></table></figure>





  <div id="df-4733cf17-6355-45a1-8704-1092d897ce3b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Weight</th>
      <th>Length</th>
      <th>Diagonal</th>
      <th>Height</th>
      <th>Width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bream</td>
      <td>242.0</td>
      <td>25.4</td>
      <td>30.0</td>
      <td>11.5200</td>
      <td>4.0200</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bream</td>
      <td>290.0</td>
      <td>26.3</td>
      <td>31.2</td>
      <td>12.4800</td>
      <td>4.3056</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bream</td>
      <td>340.0</td>
      <td>26.5</td>
      <td>31.1</td>
      <td>12.3778</td>
      <td>4.6961</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bream</td>
      <td>363.0</td>
      <td>29.0</td>
      <td>33.5</td>
      <td>12.7300</td>
      <td>4.4555</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Bream</td>
      <td>430.0</td>
      <td>29.0</td>
      <td>34.0</td>
      <td>12.4440</td>
      <td>5.1340</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4733cf17-6355-45a1-8704-1092d897ce3b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>“ height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-4733cf17-6355-45a1-8704-1092d897ce3b button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-4733cf17-6355-45a1-8704-1092d897ce3b&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<h2 id="데이터-탐색"><a href="#데이터-탐색" class="headerlink" title="데이터 탐색"></a>데이터 탐색</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 가장 신경써야 하는건 종속변수</span></span><br><span class="line"><span class="built_in">print</span>(pd.unique(fish[<span class="string">&#x27;Species&#x27;</span>]))</span><br><span class="line"><span class="built_in">print</span>(fish[<span class="string">&#x27;Species&#x27;</span>].value_counts())</span><br></pre></td></tr></table></figure>

<pre><code>[&#39;Bream&#39; &#39;Roach&#39; &#39;Whitefish&#39; &#39;Parkki&#39; &#39;Perch&#39; &#39;Pike&#39; &#39;Smelt&#39;]
Perch        56
Bream        35
Roach        20
Pike         17
Smelt        14
Parkki       11
Whitefish     6
Name: Species, dtype: int64
</code></pre>
<h2 id="데이터-가공"><a href="#데이터-가공" class="headerlink" title="데이터 가공"></a>데이터 가공</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pandas 데이터 프레임에서 numpy 배열로 변환</span></span><br><span class="line">fish_input = fish[[<span class="string">&#x27;Weight&#x27;</span>, <span class="string">&#x27;Length&#x27;</span>, <span class="string">&#x27;Diagonal&#x27;</span>, <span class="string">&#x27;Height&#x27;</span>, <span class="string">&#x27;Width&#x27;</span>]].to_numpy()</span><br><span class="line"><span class="built_in">print</span>(fish_input.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(159, 5)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(fish_input[:<span class="number">5</span>])</span><br></pre></td></tr></table></figure>

<pre><code>[[242.      25.4     30.      11.52     4.02  ]
 [290.      26.3     31.2     12.48     4.3056]
 [340.      26.5     31.1     12.3778   4.6961]
 [363.      29.      33.5     12.73     4.4555]
 [430.      29.      34.      12.444    5.134 ]]
</code></pre>
<ul>
<li>타깃 데이터 &#x3D; 종속변수 &#x3D; Y</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fish_target = fish[<span class="string">&#x27;Species&#x27;</span>].to_numpy()</span><br><span class="line"><span class="built_in">print</span>(fish_target.shape)</span><br><span class="line"><span class="built_in">print</span>(fish_target[:<span class="number">5</span>])</span><br></pre></td></tr></table></figure>

<pre><code>(159,)
[&#39;Bream&#39; &#39;Bream&#39; &#39;Bream&#39; &#39;Bream&#39; &#39;Bream&#39;]
</code></pre>
<h2 id="데이터-분리"><a href="#데이터-분리" class="headerlink" title="데이터 분리"></a>데이터 분리</h2><ul>
<li>훈련데이터 테스트 데이터 분리</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line"><span class="comment"># 임의 샘플링</span></span><br><span class="line">train_input, test_input, train_target, test_target = train_test_split(</span><br><span class="line">    fish_input, fish_target, random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 층화 샘플링</span></span><br></pre></td></tr></table></figure>

<h2 id="표준화-전처리-중요"><a href="#표준화-전처리-중요" class="headerlink" title="표준화 전처리(중요)"></a>표준화 전처리(중요)</h2><ul>
<li>여기에서도 훈련 세트의 통계값으로 테스트 세트를 변환해야 한다.<ul>
<li>데이터 세트를 나눴을 때 100개의 데이터중 70개는 훈련 세트 데이터, 30개는 테스트 데이터 일 수도 있는데, 테스트를 할때 테스트 데이터를 넣고 돌리면 답지 보고 수능 푸는 격이기 때문에, 우리는 테스트 데이터를 알지만 훈련 데이터 값으로 테스트를 해야 옳은 테스트 이다.</li>
</ul>
</li>
<li>예) 데이터 가공 할때<ul>
<li>숫자 결측치가 존재, 훈련데이터의 평균값으로 대체 해야 한다.(테스트 데이터의 결측치도 훈련데이터의 평균값으로)</li>
<li>전체데이터의 평균값으로 넣으면 X</li>
<li>따라서 훈련 데이터와 테스트 데이터는 분리 해야한다</li>
</ul>
</li>
<li>이 작업을 “데이터 누수(Data Leakage)” 라고 한다<ul>
<li>훈련 데이터 평균값 70을 대치</li>
<li>테스트 데이터 평균값 75를 대치</li>
<li>모든 데이터 평균값 73을 대치</li>
<li>이 중 뭐가 옳을까?<ul>
<li>답 : 70</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>교재 97p.</p>
<ul>
<li>기준을 맞춰라 –&gt; 데이터 표준화 (표준점수)</li>
<li>수동으로 mean, std</li>
<li>표준점수 &#x3D; (데이터 - 평균) &#x2F; 분산<br> -&gt; ss.transform(tranin_input) 으로 한방에 처리</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">ss = StandardScaler()</span><br><span class="line">ss.fit(train_input)</span><br><span class="line"><span class="comment"># ss.fit(test_input) =&gt; 이 코드는 쓰면 안된다!! 테스트 데이터값은 쓰지 않는다.</span></span><br><span class="line"></span><br><span class="line">train_scaled = ss.transform(train_input)</span><br><span class="line">test_scaled = ss.transform(test_input)</span><br></pre></td></tr></table></figure>

<h2 id="모형-만들기"><a href="#모형-만들기" class="headerlink" title="모형 만들기"></a>모형 만들기</h2><ul>
<li>K-최근접 이웃</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line">kn = KNeighborsClassifier(n_neighbors = <span class="number">3</span>)</span><br><span class="line">kn.fit(train_scaled, train_target)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(kn.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(kn.score(test_scaled, test_target))</span><br></pre></td></tr></table></figure>

<pre><code>0.8907563025210085
0.85
</code></pre>
<ul>
<li>타깃값 확인</li>
<li>알파벳 순으로 정렬</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(kn.classes_)</span><br></pre></td></tr></table></figure>

<pre><code>[&#39;Bream&#39; &#39;Parkki&#39; &#39;Perch&#39; &#39;Pike&#39; &#39;Roach&#39; &#39;Smelt&#39; &#39;Whitefish&#39;]
</code></pre>
<ul>
<li>다중분류</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(kn.predict(test_scaled[:<span class="number">5</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>[&#39;Perch&#39; &#39;Smelt&#39; &#39;Pike&#39; &#39;Perch&#39; &#39;Perch&#39;]
</code></pre>
<ul>
<li>5개 항목의 확률</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">proba = kn.predict_proba(test_scaled[:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span> (kn.classes_)</span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">round</span>(proba, decimals=<span class="number">4</span>))</span><br></pre></td></tr></table></figure>

<pre><code>[&#39;Bream&#39; &#39;Parkki&#39; &#39;Perch&#39; &#39;Pike&#39; &#39;Roach&#39; &#39;Smelt&#39; &#39;Whitefish&#39;]
[[0.     0.     1.     0.     0.     0.     0.    ]
 [0.     0.     0.     0.     0.     1.     0.    ]
 [0.     0.     0.     1.     0.     0.     0.    ]
 [0.     0.     0.6667 0.     0.3333 0.     0.    ]
 [0.     0.     0.6667 0.     0.3333 0.     0.    ]]
</code></pre>
<ul>
<li>첫번째 클래스<ul>
<li>Perch로 분류할 확률이 100%</li>
</ul>
</li>
<li>두번째 클래스<ul>
<li>Perch로 분류할 확률이 66.7%</li>
<li>Roach로 분류할 확률이 33.3%</li>
</ul>
</li>
</ul>
<h2 id="회귀-식"><a href="#회귀-식" class="headerlink" title="회귀 식"></a>회귀 식</h2><ul>
<li>y &#x3D; ax + b</li>
<li>양변에 로그를 취함</li>
</ul>
<h2 id="로지스틱-회귀로-이진-분류-수행하기"><a href="#로지스틱-회귀로-이진-분류-수행하기" class="headerlink" title="로지스틱 회귀로 이진 분류 수행하기"></a>로지스틱 회귀로 이진 분류 수행하기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">char_arr = np.array([<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>])  <span class="comment"># train_scaled 값</span></span><br><span class="line"><span class="comment"># [True, False, True, False, False] --&gt; bream_smelt_indexes</span></span><br><span class="line"><span class="built_in">print</span>(char_arr[[<span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>]])</span><br></pre></td></tr></table></figure>

<pre><code>[&#39;A&#39; &#39;C&#39;]
</code></pre>
<ul>
<li>True 값만 추출하는 원리를 이용해서</li>
<li>이 원리를 이용해서 도미와 빙어의 행만 골라보자</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bream_smelt_indexes = (train_target == <span class="string">&#x27;Bream&#x27;</span>) | (train_target == <span class="string">&#x27;Smelt&#x27;</span>)</span><br><span class="line">train_bream_smelt = train_scaled[bream_smelt_indexes]</span><br><span class="line">target_bream_smelt = train_target[bream_smelt_indexes]</span><br><span class="line"></span><br><span class="line">train_scaled.shape, train_bream_smelt.shape</span><br><span class="line"><span class="comment"># 119개에서 33개로 줄어든 데이터</span></span><br></pre></td></tr></table></figure>




<pre><code>((119, 5), (33, 5))
</code></pre>
<h2 id="모델-만들기"><a href="#모델-만들기" class="headerlink" title="모델 만들기"></a>모델 만들기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line">lr = LogisticRegression()</span><br><span class="line">lr.fit(train_bream_smelt, target_bream_smelt)</span><br></pre></td></tr></table></figure>




<pre><code>LogisticRegression()
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 클래스를 예측</span></span><br><span class="line"><span class="built_in">print</span>(lr.predict(train_bream_smelt[:<span class="number">5</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>[&#39;Bream&#39; &#39;Smelt&#39; &#39;Bream&#39; &#39;Bream&#39; &#39;Bream&#39;]
</code></pre>
<ul>
<li>확률 값 구하기</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(lr.predict_proba(train_bream_smelt[:<span class="number">5</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>[[0.99759855 0.00240145]
 [0.02735183 0.97264817]
 [0.99486072 0.00513928]
 [0.98584202 0.01415798]
 [0.99767269 0.00232731]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(lr.classes_)</span><br><span class="line"><span class="comment"># 왼쪽이 Bream 오른쪽이 Smelt</span></span><br></pre></td></tr></table></figure>

<pre><code>[&#39;Bream&#39; &#39;Smelt&#39;]
</code></pre>
<ul>
<li>분류기준 : threshold 임계값 설정 (꼭 0.5일 필요는 없다)</li>
</ul>
<p>도미 vs 빙어</p>
<p>[0.49, 0.51],</p>
<p>[0.70, 0.30],</p>
<p>[0.90, 0.10]</p>
<h2 id="계수와-절편"><a href="#계수와-절편" class="headerlink" title="계수와 절편"></a>계수와 절편</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(lr.coef_, lr.intercept_)</span><br></pre></td></tr></table></figure>

<pre><code>[[-0.4037798  -0.57620209 -0.66280298 -1.01290277 -0.73168947]] [-2.16155132]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decisions = lr.decision_function(train_bream_smelt[:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(decisions)</span><br></pre></td></tr></table></figure>

<pre><code>[-6.02927744  3.57123907 -5.26568906 -4.24321775 -6.0607117 ]
</code></pre>
<ul>
<li>이 z 값을 확률 값으로 변환(z값을 평면에 떨어뜨린다)</li>
<li>로지스틱 회귀 그래프 원리(직선그래프보다 매끄럽게 이어지는 그래프를 만듬)<br><img src="/images/0701/logic.png"></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.special <span class="keyword">import</span> expit</span><br><span class="line"><span class="built_in">print</span>(expit(decisions))</span><br></pre></td></tr></table></figure>

<pre><code>[0.00240145 0.97264817 0.00513928 0.01415798 0.00232731]
</code></pre>
<h2 id="다중-분류-수행하기"><a href="#다중-분류-수행하기" class="headerlink" title="다중 분류 수행하기"></a>다중 분류 수행하기</h2><ul>
<li>이진 분류의 확장판</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 하이퍼 파라미터 세팅</span></span><br><span class="line"><span class="comment"># 모형을 튜닝</span></span><br><span class="line"><span class="comment"># 웬만하면 순정(default) 쓰세요.</span></span><br><span class="line"><span class="comment"># 모형 결과의 과대적합 또는 과소적합을 방지 하기 위한 것</span></span><br><span class="line">lr = LogisticRegression(C = <span class="number">20</span>, max_iter = <span class="number">1000</span>)</span><br><span class="line">lr.fit(train_scaled, train_target)</span><br><span class="line"><span class="built_in">print</span>(lr.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(lr.score(test_scaled, test_target))</span><br></pre></td></tr></table></figure>

<pre><code>0.9327731092436975
0.925
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(lr.predict(test_scaled[:<span class="number">5</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>[&#39;Perch&#39; &#39;Smelt&#39; &#39;Pike&#39; &#39;Roach&#39; &#39;Perch&#39;]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proba = lr.predict_proba(test_scaled[:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">round</span>(proba,decimals = <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(lr.classes_)</span><br></pre></td></tr></table></figure>

<pre><code>[[0.    0.014 0.841 0.    0.136 0.007 0.003]
 [0.    0.003 0.044 0.    0.007 0.946 0.   ]
 [0.    0.    0.034 0.935 0.015 0.016 0.   ]
 [0.011 0.034 0.306 0.007 0.567 0.    0.076]
 [0.    0.    0.904 0.002 0.089 0.002 0.001]]
[&#39;Bream&#39; &#39;Parkki&#39; &#39;Perch&#39; &#39;Pike&#39; &#39;Roach&#39; &#39;Smelt&#39; &#39;Whitefish&#39;]
</code></pre>
<ul>
<li>다중 분류일 경우 선형 방정식은 어떤 모습일까?<ul>
<li>7개 분류, 5개 컬럼 값에 선형 방정식</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(lr.coef_.shape, lr.intercept_.shape)  </span><br></pre></td></tr></table></figure>

<pre><code>(7, 5) (7,)
</code></pre>
<h2 id="평가지표"><a href="#평가지표" class="headerlink" title="평가지표"></a>평가지표</h2><h3 id="회귀-평가지표"><a href="#회귀-평가지표" class="headerlink" title="회귀 평가지표"></a>회귀 평가지표</h3><ul>
<li>결정계수 (교재 121p)<ul>
<li>1 - (타깃 - 예측)^2의 합 &#x2F; (타깃 - 평균)^2의 합</li>
</ul>
</li>
<li>mae, mse, rmse 만 기억<ul>
<li>(실제 - 예측) &#x3D; 오차</li>
<li>mae(mean absolute error) : 오차의 절댓값의 평균</li>
<li>mse(mean squared error) : 오차 제곱의 평균</li>
<li>rmse(root mean squared error) : mse에 제곱근을 취한 값</li>
</ul>
</li>
<li>좋은 모델의 기준<ul>
<li>결정계수 : 1에 수렴하면 좋은 모델</li>
<li>mae, msem, rmse : 0에 수렴하면 좋은 모델</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error, mean_squared_error, r2_score</span><br><span class="line"></span><br><span class="line">true = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">8</span>]) <span class="comment"># 실제값</span></span><br><span class="line">preds = np.array([<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">8</span>]) <span class="comment"># 예측값</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 절댓값 오차의 평균</span></span><br><span class="line">mae = mean_absolute_error(true, preds)</span><br><span class="line"><span class="built_in">print</span>(mae)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 제곱 오차의 평균</span></span><br><span class="line">mse = mean_squared_error(true,preds)</span><br><span class="line"><span class="built_in">print</span>(mse)</span><br><span class="line"></span><br><span class="line"><span class="comment"># np.squt : 루트 씌워주는 함수</span></span><br><span class="line">rmse = np.sqrt(mse)</span><br><span class="line"><span class="built_in">print</span>(rmse)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 결정계수</span></span><br><span class="line">r2 = r2_score(true, preds)</span><br><span class="line"><span class="built_in">print</span>(r2)</span><br></pre></td></tr></table></figure>

<pre><code>0.5384615384615384
0.6923076923076923
0.8320502943378437
0.8617021276595744
</code></pre>
<h3 id="분류-평가지표"><a href="#분류-평가지표" class="headerlink" title="분류 평가지표"></a>분류 평가지표</h3><ul>
<li>오차 행렬</li>
<li>실제 값<ul>
<li>[빙어, 도미, 도미, 빙어, 도미]</li>
</ul>
</li>
<li>예측 값<ul>
<li>[빙어, 빙어, 도미, 빙어, 빙어]</li>
</ul>
</li>
</ul>
<p>TP(빙어를 빙어로 예측) &#x3D; 2개<br>TN(도미를 도미로 예측) &#x3D; 1개<br>FN(도미를 빙어로 예측) &#x3D; 2개<br>FP(빙어를 도미로 예측) &#x3D; 0개</p>
<ul>
<li><p>TP, TN, FP, FN</p>
</li>
<li><p>예) TP &#x3D; 5, TN &#x3D; 5, FP &#x3D; 3, FN &#x3D; 7</p>
</li>
<li><p>모든 케이스에서 정확도로 처리할 수 없으므로 정밀도, 재현율 파악도 중요하다.</p>
<ul>
<li><p>정확도 : 전체 중에 맞춘 갯수</p>
<ul>
<li>(TP + TN) &#x2F; (TP + TN + FP + FN)</li>
</ul>
</li>
<li><p>정밀도 : 양성(Positive)이라고 예측한 값 중 실제 양성인 값의 비율</p>
<ul>
<li>TP &#x2F; (TP + FP)</li>
</ul>
</li>
<li><p>재현율 : 양성(Positive)인 실제 값 중 양성으로 예측한 값(TP)의 비율(암진단 같은 경우)</p>
<ul>
<li>TP &#x2F; (TP + TF)</li>
</ul>
</li>
<li><p>로그손실</p>
</li>
<li><p>ROC Curve (&#x3D; AUC)</p>
</li>
</ul>
</li>
<li><p>이 모형의 정확도 3&#x2F;5 &#x3D; 60%</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"></span><br><span class="line">true = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">preds = [<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">confusion_matrix(true, preds)</span><br></pre></td></tr></table></figure>




<pre><code>array([[2, 1],
       [2, 0]])
</code></pre>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/07/04/day0704/"
                    data-tooltip="day 0704"
                    aria-label="이전: day 0704"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/07/01/day0701_ch03/"
                    data-tooltip="day 0701_ch3"
                    aria-label="다음: day 0701_ch3"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#gitment"
                        aria-label="댓글을 남겨주세요"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="gitment"></div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2023 오세영. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="3">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/07/04/day0704/"
                    data-tooltip="day 0704"
                    aria-label="이전: day 0704"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/07/01/day0701_ch03/"
                    data-tooltip="day 0701_ch3"
                    aria-label="다음: day 0701_ch3"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#gitment"
                        aria-label="댓글을 남겨주세요"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="3">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                        aria-label="Facebook에 공유하기"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                        aria-label="Twitter에 공유하기"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://neewlife.github.io/2022/07/01/day0701_ch04/"
                        aria-label="Google+에 공유하기"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Google+에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">오세영</h4>
        
            <div id="about-card-bio"><p>긍정적인 마인드로 오늘도 가보자~</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>웹 백앤드 지망생</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                경기 광명시
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-2fuib8u2axf9gspqm6aasoaqzlxwxraygijqllh1qbnh6xertrgkmj0rcdyi.min.js"></script>

<!--SCRIPTS END-->


    
        
<script src="/assets/js/gitment.js"></script>

        <script type="text/javascript">
          (function() {
            new Gitment({
              id: 'https://neewlife.github.io/2022/07/01/day0701_ch04/',
              owner: '',
              repo: '',
              oauth: {
                client_id: '',
                client_secret: ''
              }
            }).render('gitment')
          })()
        </script>
    




    </body>
</html>
