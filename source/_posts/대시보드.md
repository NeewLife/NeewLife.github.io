---
title: "Python 대시보드 만들기"
output:
  html_document:
    keep_md: true
disqusIdentifier: fdsF34ff34
categories: python
clearReading: true
metaAlignment: center
date: '2022-08-24 23:27:20'
---

홈페이지 만들기
<!-- excerpt -->

# 대시보드


- 웹 개발 프로젝트
- 대시보드 오픈소스 / 유료 툴

### Flask 관련

- 효율적으로 디자인 패턴하기(중요)
- 웹 개발도 가능하게

### R

- Shiny 대시보드 프레임워크 로 통합되어있음

### Python

- 웹 개발 프레임워크가 Django, Flask 가 있는 것처럼
    
    Python 프레임워크는 한두개가 아니라 다양하다.
    

대시보드 = 시각화를 예쁘게 해주는 코드

좀 더 세부적으로 하고 싶다면 plotly 를 써야 함

- 구글에 python dashboard framework 만 쳐도 엄청 나옴
- dash python 주로 쓴다

### Python(유료툴)

- 대세 : 태블로, PowerBi

### Java 스크립트 내 Python 코드 호출

- Jpython (에러가 많음)
- 차라리 외부에서 만들고 iframe 형태로 만들어라

---

# Flask를 가지고 대시보드 만들기

폴더를 하나 생성 후 VSCode 로 연다.

가상환경 설정 후, 다음 코드를 입력한다.

![Untitled](/images/대시보드/Untitled.png)

```python
pip install dash plotly Flask pandas gunicorn psycopg2-binary SQLAlchemy Flask-SQLAlchemy
```

- 지금까지는 [app.py](http://app.py)에 전부 다 스킬 코드를 집어 넣었지만,
    
    이렇게 app 객체를 전역으로 사용하면 “순환참조오류” 가 발생할 확률이 높음
    

- 순환참조오류 : A → B , B → A  가 발생하는 경우. 무한반복됨

- 그렇다면 어떻게 해야되냐
    
    app ‘폴더’ 를 하나 만들고 ‘__init__.py’ 라는 ‘파일’ 을 하나 생성한다.
    

![Untitled](/images/대시보드/Untitled%201.png)

- 가상환경에 접속한다.

```bash
virtualenv venv # 가상환경 생성
source venv/Scripts/activate # 가상환경 접속
```

- 필수 라이브러리를 설치한다

```bash
pip install dash plotly Flask pandas gunicorn psycopg2-binary SQLAlchemy Flask-SQLAlchemy
```

- `__init__.py` 파일에 다음 코드를 작성한다.

```python
# app/__init__.py
import os

from flask import Flask

def create_app(test_config=None):
    app = Flask(__name__, instance_relative_config=True)
    app.config.from_mapping(
        SECRET_KEY = 'development'
    )

    if test_config is None:
        app.config.from_pyfile('config.py', silent=True)
    else:
        app.config.from_mapping(test_config)

    try:
        os.makedirs(app.instance_path)
    except OSError:
        pass

    return app
```

- `main` 파일을 하나 만들고 다음 블루프린트 코드를 작성한다

```python
# app/main.py
from flask import Blueprint, render_template

bp = Blueprint('main', __name__, url_prefix='/')

@bp.route('/')
def main():
    return "Hello World!"
```

- `__init__.py` 와 `main` 을 연결시키기 위해서 `__init__.py` 파일에 경로를 추가한다.
    
    ![Untitled](/images/대시보드/Untitled%202.png)
    

```python
from . import main
app.register_blueprint(main.bp)
```

- 이번에는 [`wsgi.py`](http://wsgi.py) 파일을 만들고 그 안에 코드를 작성한다

```python
from app import create_app

app = create_app()

if __name__ == "__main__":
    app.run(host='0.0.0.0', debug=True)
```

- 이제 flask run 을 터미널에 입력해서 서버테스트를 한다.(파일 위치는 다음과 같음)
    
    ![Untitled](/images/대시보드/Untitled%203.png)
    
    ![Untitled](/images/대시보드/Untitled%204.png)
    

## templates 폴더

- 이번에는 templates 폴더를 하나 만든다.
- bootstrap 5.2.0 버전을 활용하여 base.html 및 main.html 파일을 생성하여 Manu Bar와 Hello World를 출력하는 코드를 작성한다.
- 이 때 확장자명 html 파일은 모두 jinja2로 저장하는 것에 주의한다.

### 1. header.jinja2 파일 작성

- app/templates/header.jinja2   이렇게 파일을 만든다.
    - header.jinja2 파일에 아래 코드를 작성한다.
    
    ```html
    <ul class="nav">
      <li class="nav-item">
        <a class="nav-link active" aria-current="page" href="/main">Main</a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/dashapp1">Dashapp1</a>
      </li>
    </ul>
    ```
    

### 2. base.jinja2 파일 작성

- 이번에는 base.jinja2 파일을 만들고 header.jinja2 파일을 불러오자

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bootstrap demo</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    {% include 'header.jinja2' %}
    <br />
    <div class="container">{% block content %} {% endblock %}</div>
  </body>
</html>
```

## main 페이지 작성

- app폴더에 main “폴더” 를 만든다
- main 폴더 내부에 templates 폴더와 `[main.py](http://main.py)` 를 생성한다

- templates 폴더 내부에 main.jinja2 파일을 만든 후 다음 코드를 작성한다\

```html
{% extends "base.jinja2" %}

{% block content %}
<h1>Hello World</h1>

{% endblock %}
```

- `[main.py](http://main.py)` 에 다음 코드를 입력한다

```python
# app/main/main.py
from flask import Blueprint, render_template

bp = Blueprint('main', __name__, template_folder = "templates", url_prefix='/')

@bp.route('/')
def main():
    return render_template("main.jinja2", title = 'main page')
```

- `app/__init__.py` 파일에서 main 코드의 일부 경로를 수정한다
    
    ![Untitled](/images/대시보드/Untitled%205.png)
    

```python
# app/__init__.py
import os

from flask import Flask

def create_app(test_config=None):
    app = Flask(__name__, instance_relative_config=True)
    app.config.from_mapping(
        SECRET_KEY = 'development'
    )
.
.
from .main import main
app.register_blueprint(main.bp)

return app
```

- 이제 flask run 을 해서 서버테스트를 한다.

flask 애플리케이션 팩토리 블루프린트를 이해해야함